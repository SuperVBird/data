{"id":203061,"link":"https://chinadigitaltimes.net/chinese/2011/12/翻墙-代理自动配置脚本――pac文件/","date":"2011-12-27T09:01:22Z","modified":"2011-12-27T09:01:22Z","title":"翻墙 | 代理自动配置脚本――PAC文件","content":"<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://yangcheng2503.blogspot.com/2011/12/pac.html\">http://yangcheng2503.blogspot.com/2011/12/pac.html</a></p>\n<div>\n<div>\n<div>\n<div>\n<h2>什么是PAC？</h2>\n<p>A  proxy auto-config (PAC) file defines how web browsers and other user  agents can automatically choose the appropriate proxy server (access  method) for fetching a given URL.（摘自Wikipedia）</p>\n<p>正如这句定义，PAC文件被用来决定某一次网络访问所使用的代理。说得通俗点，就是当你访问某个网站时，由PAC文件判断该不该使用代理，或使用哪一个代理。</p>\n<h2>为什么会用到PAC？</h2>\n<p>这有什么用？如果你发问，那你要么不懂网络要么肯定没在大陆待过。在大陆的人都知道<b>GFW</b>， 它是互联网上的文字狱，是自由精神的枷锁，是中华名族的樊篱，如果要自由上网就必须&#8221;翻墙&#8221;。很多翻墙工具都是代理性质的（如Wallproxy、 GoAgent等），但是这些代理在访问大陆网站的时候又会增加延迟、拖慢网速。若能在访问被墙网站（如Facebook、Twitter）时通过代理连 接，在访问其他网站时直接连接，就能实现既&#8221;翻墙&#8221;，又不会因代理拖慢其他网站速度。实现这一想法的最便捷方案就是PAC文件。</p>\n<p>还有另一 部分人（包括我在内），使用中国教育网，只能访问极少一部分大陆网站，不能访任何外国站。这部分人对能够自动配置代理的PAC文件有更强烈的需求。因为教 育网要访问外国站就必须加代理，但是通过代理又无法访问教育网网站。如果不能自动配置代理，那么上网过程将会伴随不断的切换代理。而切换代理那繁琐的过程 相信没有任何一个人愿意忍受。</p>\n<h2>如何构造PAC文件？</h2>\n<p> <span></p>\n<p>PAC文件其实可看作是一个JavaScript脚 本，只不过它仅支持其中一部分命令。PAC文件必须包含一个FindProxyForURL(url,  host)函数，这个函数可以看作是PAC文件的主函数，任何网络访问请求都会由系统传给这个函数。参数url就是要访问的URL，host就是要访问的 URL所包含的主机。例如访问<a rel=\"nofollow\" target=\"_blank\" href=\"http://en.wikipedia.org/wiki/Proxy_auto-config\" title=\"http://en.wikipedia.org/wiki/Proxy_auto-config\">http://en.wikipedia.org/wiki/Proxy_auto-config</a>，URL就是它本身，host就是<a rel=\"nofollow\" target=\"_blank\" href=\"http://en.wikipedia.org\">en.wikipedia.org</a>。下面举两个Wikipedia中的例子来说明这个函数的用法：</p>\n<div>\n<pre> <span>function</span> FindProxyForURL(url, host) <br />    <span>return</span> <span>\"PROXY <a rel=\"nofollow\" target=\"_blank\" href=\"http://proxy.example.com:8080\">proxy.example.com:8080</a>\"</span>;<br />  </pre>\n<p></div>\n<p></p>\n<p>上面这两句就可以作为一个PAC文件，它对所有URL都返回同一个代理。也就是说这个PAC会让所有访问都通过<a rel=\"nofollow\" target=\"_blank\" href=\"http://proxy.example.com:8080\">proxy.example.com:8080</a>这个代理。</p>\n<p></p>\n<p>下面这个相对复杂一些：</p>\n<p></p>\n<div>\n<pre> <span>function</span> FindProxyForURL(url, host) <br />    <span>//<a rel=\"nofollow\" target=\"_blank\" href=\"http://xn--6kqx04a1ze9of.edu.cn\">对于所有.edu.cn</a>域名，直接连接</span><br />    <span>if</span> (shExpMatch(url,<span>\"*.<a rel=\"nofollow\" target=\"_blank\" href=\"http://edu.cn/*\">edu.cn/*</a>\"</span>))    <span>return</span> <span>\"DIRECT\"</span>;<br />      <span>//对于10.0.0.0到10.0.0.255之间的IP地址使用代理</span><br />    <span>if</span> (isInNet(host, <span>\"10.0.0.0\"</span>,  <span>\"255.255.255.0\"</span>))    <br />          <span>return</span> <span>\"PROXY <a rel=\"nofollow\" target=\"_blank\" href=\"http://proxy.example.com:8080\">proxy.example.com:8080</a>\"</span>;<br />    <br />    <span>//其他网站尝试使用代理访问，代理无效时，直接访问</span><br />      <span>return</span> <span>\"PROXY <a rel=\"nofollow\" target=\"_blank\" href=\"http://proxy.example.com:8080\">proxy.example.com:8080</a>; DIRECT\"</span>;<br />}</pre>\n<p></div>\n<p></p>\n<p>这 个例子说明了JavaScript函数在PAC文件中的使用方法。例子中，<a rel=\"nofollow\" target=\"_blank\" href=\"http://xn--onqs58b9od.edu.cn\">所有以.edu.cn</a>作为域名的网站都将采用直接连接，所有在10.0.0.0 到<a rel=\"nofollow\" target=\"_blank\" href=\"http://10.0.0.xn--255proxy-dl0m62cjrv25aglmmy0djx0bulix8sl4sxp5eombf6i2q8a.example.com\">10.0.0.255之间的网站都会通过代理服务器proxy.example.com</a>的8080端口连接（即使这个代理不可用）。其他一切网络连接都 将尝试通过<a rel=\"nofollow\" target=\"_blank\" href=\"http://proxy.example.com:8080\">proxy.example.com:8080</a>连接，如果代理无响应则直接连接。关于PAC文件更详尽的格式说明请参考《<a rel=\"nofollow\" target=\"_blank\" href=\"http://web.archive.org/web/20061218002753/wp.netscape.com/eng/mozilla/2.0/relnotes/demo/proxy-live.html\" title=\"Navigator Proxy Auto-Config File Format\">Navigator Proxy Auto-Config File Format</a>》，如果有兴趣你也可以阅读一些扩展内容《<a rel=\"nofollow\" target=\"_blank\" href=\"http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/web-browser-auto-proxy-configuration.html\" title=\"Automatic proxy HTTP server configuration in web browsers\">Automatic proxy HTTP server configuration in web browsers</a>》。</p>\n<p></p>\n<p>有一点不得不提到的是：大多数系统和浏览器只支持ANSI编码的PAC文件，如果使用其他编码（如Unicode）将无法识别。</p>\n<p><b>PAC文件怎么用？</b></p>\n<p>对 于Windows系统，直接在&#8221;Internet选项&#8221;中，&#8221;连接&#8221;标签，&#8221;局域网设置&#8221;按钮，选中&#8221;使用自动配置脚本&#8221;，下面的地址栏填写PAC文件的 URL。例如有个auto.pac在你的D盘根目录，则填写&#8221;file://d:/auto.pac&#8221;；如果这个pac在网络主机上，你就需要填成类似 &#8220;<a rel=\"nofollow\" target=\"_blank\" href=\"http://genghis-yang.tk/something/auto.pac\">http://genghis-yang.tk/something/auto.pac</a>&#8220;这样。</p>\n<p></p>\n<p><img alt=\"Windows代理配置图解\" height=\"312\" src=\"http://pic.dbank.com/p0oqbazz9q.png\" title=\"Windows代理配置图解\" width=\"500\" /> </p>\n<p></p>\n<p>对于Firefox浏览器，&#8221;首选项&#8221;中&#8221;高级选项卡&#8221;，&#8221;网络&#8221;标签，&#8221;设置&#8221;按钮，在&#8221;自动代理配置URL&#8221;中填入你的PAC。</p>\n<p></p>\n<p><img alt=\"Firefox代理配置图解\" src=\"http://pic.dbank.com/p0daboajk6.png\" title=\"Firefox代理配置图解\" /> </p>\n<p></p>\n<p>对于Linux系统（以ubuntu10.04为例），在&#8221;系统设置&#8221;里面打开&#8221;网络代理首选项&#8221;，在&#8221;自动代理配置&#8221;中填入PAC的URL。</p>\n<p></p>\n<p><img alt=\"ubuntu代理配置图解\" height=\"453\" src=\"http://pic.dbank.com/p0q1v8s1p6.png\" title=\"ubuntu代理配置图解\" width=\"500\" /> </p>\n<p></p>\n<p>其他配置方式也很雷同，这里就不赘述了。</p>\n<p><b>请支持我的GoogleCode项目</b></p>\n<p>我在Google Code上开了一个项目――<a rel=\"nofollow\" target=\"_blank\" href=\"http://code.google.com/p/pac-maker/\" title=\"http://code.google.com/p/pac-maker/\">pac-maker</a>， 做教育网代理自动配置脚本，包括一个按月更新的PAC文件和一个PAC文件自动生成程序。它主要是为教育网这个特殊群体服务的，主要目的就是让教育网不可 访问的IP自动使用代理，而可访问的则直接访问。这个工程刚刚起步，还存在一些问题，期待有人能加入进来，或者提交些Issues，把它做得更好。</p>\n<p>  </span></p>\n<div><img alt=\"\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5641152208300683095-6763991108551330228?l=yangcheng2503.blogspot.com\" width=\"1\" /></div>\n</p></div>\n</div>\n</div>\n</div>\n<div><span></span><span></span><span></span></div>\n<p> </p>\n<div>翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a><img alt=\"\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5500297126185736776-2001399703752791666?l=www.chinagfw.org\" width=\"1\" /></div>\n<p><img height=\"1\" src=\"http://feeds.feedburner.com/~r/ChinaGfw/~4/w7XrRgFwbrM\" width=\"1\" /></p>\n<p><img src=\"https://chinadigitaltimes.net/chinese/files/2011/12/377f2e21p0oqbazz9q.png-150x150.png\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=738338\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"738338\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":1005,"categories":[15300],"tags":[7775,8800,8817]}