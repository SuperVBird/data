{"id":277770,"link":"https://chinadigitaltimes.net/chinese/2013/02/翻墙-多台电脑如何共享翻墙通道/","date":"2013-02-04T13:45:17Z","modified":"2013-02-04T13:45:17Z","title":"翻墙 | 多台电脑如何共享翻墙通道","content":"<p><span></p>\n<h2>★引子</h2>\n<p><span>　　元旦前后，俺写了《</span><a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2010/04/howto-cover-your-tracks-0.html\">如何隐藏你的踪迹，避免跨省追捕</a><span>》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。</span><br /><span>　　所以，俺今天就来聊一聊&#8221;多台电脑共享翻墙通道&#8221;这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。</span></p>\n<p><span>　　顺便说一下：在《</span><a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2013/01/howto-cover-your-tracks-7.html\">用虚拟机隐匿公网IP（配置图解）</a><span>》一文的末尾，俺又补充了一个章节——&#8221;验证虚拟机的隔离性&#8221;。那些使用虚拟机方案隐匿公网IP的同学，为了保险起见，要记得验证一下隔离性。</span></p>\n<h2>★准备工作</h2>\n<p><span>　　考虑到俺博客的读者，有很多人不是 IT 技术人员。所以，俺先通俗地扫盲若干基础知识。</span></p>\n<h3>◇什么是&#8221;翻墙&#8221;</h3>\n<p><span>　　如果你对&#8221;翻墙&#8221;还不太了解，建议你先看看俺写的《</span><a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2009/05/how-to-break-through-gfw.html\">如何翻墙</a><span>》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。</span></p>\n<h3>◇什么是&#8221;代理&#8221;</h3>\n<p><span>　　&#8221;代理&#8221;好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。</span><br /><span>　　翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤：</span><br /><span>1. 浏览器发送数据到代理软件</span><br /><span>2. 代理软件把你的数据发送到墙外的代理服务器</span><br /><span>3. 代理服务器发送数据到目标网站</span></p>\n<h3>◇什么是&#8221;监听端口&#8221;</h3>\n<p><span>　　代理软件要正常工作，通常都需要开启一个&#8221;监听端口&#8221;。浏览器通过这个&#8221;监听端口&#8221;来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。</span></p>\n<h3>◇如何看本机开启的监听端口</h3>\n<p><span>　　对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的所有监听端口。</span></p>\n<blockquote><p>netstat -an | find &#8220;LISTEN&#8221;</p></blockquote>\n<p><span>　　刚才有读者在留言中提问，俺再补充一下。用 netstat 的 o 选项可以看到每个监听端口分别是哪个进程开启的。命令如下</span></p>\n<blockquote><p>netstat -ano | find &#8220;LISTEN&#8221;</p></blockquote>\n<p></p>\n<h3>◇什么是监听端口的&#8221;绑定地址&#8221;</h3>\n<p><span>　　以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下</span></p>\n<blockquote><p>TCP　　127.0.0.1:8118　　0.0.0.0:0　　LISTENING</p></blockquote>\n<p><span>　　其中的 127.0.0.1 表示这个监听端口绑定的网卡地址，而 8118 表示监听的端口号。所谓的&#8221;绑定地址&#8221;，意思就是说，这个监听端口只接受来自该网卡的连接。</span><br /><span>　　因为 127.0.0.1 表示本机网卡地址；所以，绑定在 127.0.0.1 表示该监听端口只接受来自本机的连接。</span><br /><span>　　如果要让某个监听端口接受任意连接（包括外部电脑的连接），可以把绑定地址设置为 0.0.0.0</span></p>\n<h3>◇小心防火墙的配置</h3>\n<p><span>　　在《</span><a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2013/01/howto-cover-your-tracks-7.html\">用虚拟机隐匿公网IP</a><span>》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。</span><br /><span>　　俺再啰嗦一下：</span><br /><span><b>要特别小心操作系统中防火墙的设置</b></span><span>。很多人是因为防火墙没设好，导致代理无法连通。</span></p>\n<h2>★如何共享翻墙的代理？</h2>\n<p></p>\n<h3>◇问题</h3>\n<p><span>　　大部分翻墙代理都会提供一个 HTTP 的代理端口（就是刚才说的&#8221;监听端口&#8221;）。问题在于：很多翻墙代理的代理端口都绑定在 127.0.0.1 上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。</span></p>\n<h3>◇解决方案之 &#8220;修改配置&#8221;</h3>\n<p><span>　　最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 0.0.0.0 上。</span></p>\n<p><b>自由门</b><br /><span>到它的设置界面，点&#8221;更多设置&#8221;，然后勾选&#8221;用自由门做服务器&#8221;，可以把监听端口绑定到 0.0.0.0</span><br /><b>GoAgent</b><br /><span>GoAgent 的配置信息存储在 proxy.ini 文件中。打开该文件找到 [listen] 字段，然后把该字段下面的 127.0.0.1 改为 0.0.0.0 即可。</span></p>\n<p><span>　　可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，无需修改配置文件，可以</span><b>搞定任何翻墙代理</b><span>，让它的监听端口被外部电脑使用。</span></p>\n<h3>◇解决方案之 &#8220;端口转发&#8221;</h3>\n<p><span>　　所谓的&#8221;端口转发&#8221;，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。</span><br /><span>B 监听端口就是你的翻墙软件原先开启的端口</span><br /><span>A 监听端口是新开的，而且绑定地址是 0.0.0.0</span><br /><span>　　如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用&#8221;端口转发&#8221;功能，把数据转向 B 端口（也就是翻墙工具自身的端口）</span></p>\n<h2>★如何搞端口转发？</h2>\n<p><span>　　端口转发是本文的重点，所以俺单独开一个章节详细说。</span><br /><span>　　用来搞端口转发的工具有很多，如果你去 Google 一下 &#8220;TCP proxy&#8221; 或 &#8220;TCP redirection&#8221;，应该能找到一大堆软件和解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。</span></p>\n<h3>◇利用 Windows 自带的 netsh</h3>\n<p><b>准备工作</b><br /><span>对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 &#8230;）可以直接使用该方案。</span><br /><span>对于 Vista 之前的 Windows（比如 WinXP、Win2003），需要先安装 IPv6 协议栈。具体步骤如下：</span><br /><span>1. 以管理员身份登录，进入&#8221;控制面板&#8221;下面的&#8221;网络连接&#8221;</span><br /><span>2. 选中本地连接，点右键，在右键菜单选&#8221;属性&#8221;</span><br /><span>3. 弹出&#8221;属性&#8221;对话框，点&#8221;安装&#8221;按钮</span><br /><span>4. 弹出&#8221;选择网络组件类型&#8221;对话框，选&#8221;协议&#8221;，再点&#8221;添加&#8221;</span><br /><span>5. 在弹出的对话框中选&#8221;IPv6&#8243;，点&#8221;确定&#8221;</span></p>\n<p><b>命令详解</b><br /><span>（以下命令需要管理员身份才能执行）</span><br /><span>添加端口转发的命令</span></p>\n<blockquote><p>netsh interface portproxy add v4tov4 listenport=<i>新开的监听端口</i></p>\n","author":1005,"categories":[18269,15300],"tags":[8795]}