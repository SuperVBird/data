{"id":172014,"link":"https://chinadigitaltimes.net/chinese/2011/08/快速切换ipv4ipv6-host的脚本/","date":"2011-08-14T01:00:28Z","modified":"2011-08-14T01:00:28Z","title":"快速切换IPv4/IPv6 host的脚本","content":"<p><p>来源：<a href=\"http://logicmd.net/2011/06/a-script-quickly-switch-ipv4-ipv6-host/\">http://logicmd.net/2011/06/a-script-quickly-switch-ipv4-ipv6-host/</a>    </p>\n<p><a href=\"http://logicmd.net/2010/04/high-speed-visiting-abroad-websites-using-ipv6/\">这篇文章</a>讲了一些Google等国外网站<span><a href=\"http://logicmd.net/tag/ipv6/\" title=\"查看 IPv6 中的全部文章\">IPv6</a></span> host列表。使用它们速度更快，更无<a href=\"http://www.google.com.hk/search?q=%E7%95%AA%E7%BE%BD%E5%9C%9F%E5%95%AC\">束缚</a>。但是如果在一个<span><a href=\"http://logicmd.net/tag/ipv6/\" title=\"查看 IPv6 中的全部文章\">IPv6</a></span>经常坏掉的校园网，或者需要经常移动到没有<span><a href=\"http://logicmd.net/tag/ipv6/\" title=\"查看 IPv6 中的全部文章\">IPv6</a></span>的网络中，一个切换IPv4/<span><a href=\"http://logicmd.net/tag/ipv6/\" title=\"查看 IPv6 中的全部文章\">IPv6</a></span> host列表的脚本无疑很重要。      <br /><span></span></p>\n<p></p>\n<h2><span><a href=\"http://logicmd.net/tag/windows/\" title=\"查看 Windows 中的全部文章\">Windows</a></span>平台</h2>\n<p><p>Window平台中host列表存放在 <code>%windir%System32driversetc</code>，我们规定<span><a href=\"http://logicmd.net/tag/ipv6/\" title=\"查看 IPv6 中的全部文章\">IPv6</a></span>的hosts存放在hosts.v6，IPv4的hosts存放在hosts.v4，处于其中一个状态时其内容存放在hosts文件中，使用如下batch则可以完成hosts状态的判断。</p>\n<p><pre>::\tDescription: ::\t  This batch is used to switch host files from ipv4 to ipv6 or the other.  @ECHO OFF SET FileLocation=%WINDIR%System32driversetc SET IPV4FileName=hosts.v4 SET IPV6FileName=hosts.v6 SET TargetFileName=hosts  :: If host.ipv6 exits, switch to IPV6, else switch to IPV4 IF EXIST %FileLocation%%IPV6FileName% (  \t:: Switch to IPV6 \tCHOICE /M \"Swithed to IPv6?\" /T 0020 /D N \tIF ERRORLEVEL 2 GOTO END \tIF ERRORLEVEL 1 ECHO Successfully Switched to IPv6 Hosts!  \tREN %FileLocation%%TargetFileName% %IPV4FileName% \tREN %FileLocation%%IPV6FileName% %TargetFileName%  ) ELSE IF EXIST %FileLocation%%IPV4FileName% (  \t:: Switch to IPV4 \tCHOICE /M \"Swithed to IPv4?\" /T 0020 /D N \tIF ERRORLEVEL 2 GOTO END \tIF ERRORLEVEL 1 ECHO Successfully Switched to IPv4 Hosts!  \tREN %FileLocation%%TargetFileName% %IPV6FileName% \tREN %FileLocation%%IPV4FileName% %TargetFileName%  )  PAUSE EXIT  :END ECHO Nothing changed!</pre>\n</p>\n<p>在<span><a href=\"http://logicmd.net/tag/windows/\" title=\"查看 Windows 中的全部文章\">Windows</a></span> vista和 <span><a href=\"http://logicmd.net/tag/windows/\" title=\"查看 Windows 中的全部文章\">Windows</a></span> 7系统中，有用户帐户控制（UAC），总是右键去点击使用管理员权限执行会麻烦，一个解决方案是使用<a href=\"http://logicmd.net/wp-content/uploads/2011/06/quickbfc.exe\">Quick batch file compiler</a>将其编译成exe，然后设定成总是需要管理员权限即可。</p>\n<p>最终生成的是SwitchHosts.exe文件。</p>\n</p>\n<h2><span><a href=\"http://logicmd.net/tag/linux/\" title=\"查看 Linux 中的全部文章\">Linux</a></span>平台</h2>\n</p>\n<p><span><a href=\"http://logicmd.net/tag/linux/\" title=\"查看 Linux 中的全部文章\">Linux</a></span>平台中host列表存放在 <code>etc</code>，我们做同样的文件名规定。</p>\n</p>\n<pre>#!/bin/bash #Description: #This scripts is used to switch host files from ipv4 to ipv6 or the other. if [ -f /etc/hosts.v6 ] # Now using ipv4 mode then \tsudo cp /etc/hosts /etc/hosts.v4 \tsudo cp /etc/hosts.v6 /etc/hosts \tsudo rm -f /etc/hosts.v6 \techo \"Successfully switched to ipv6 hosts!\" elif [ -f /etc/hosts.v4 ] # Now using ipv6 mode then \tsudo cp /etc/hosts /etc/hosts.v6         sudo cp /etc/hosts.v4 /etc/hosts         sudo rm -f /etc/hosts.v4 \techo \"Successfully switched to ipv4 hosts!\" else \techo \"ERROR! No Backup File is found!\" fi </pre>\n</p>\n<p>最后 </p>\n<pre>chmod switch 644 cp ./switch /usr/bin</pre>\n</p>\n<p>之后直接在terminal中输入switch即可~</p>\n<p>在Ubuntu 10.04测试通过。</p>\n<p>EOF</p>\n<p>  <a href=\"http://feeds.wordpress.com/1.0/gocomments/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/comments/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godelicious/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/delicious/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gofacebook/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/facebook/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gotwitter/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/twitter/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gostumble/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/stumble/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godigg/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/digg/xijie.wordpress.com/4920/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/goreddit/xijie.wordpress.com/4920/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/reddit/xijie.wordpress.com/4920/\" /></a> <img alt=\"\" border=\"0\" height=\"1\" src=\"http://stats.wordpress.com/b.gif?host=xijie.wordpress.com&#038;blog=10068099&#038;post=4920&#038;subd=xijie&#038;ref=&#038;feed=1\" width=\"1\" /></p>\n<div></div>\n</p>\n</p>\n</p>\n<p><img src=\"http://feeds.wordpress.com/1.0/comments/xijie.wordpress.com/4920/\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=750556\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"750556\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":414,"categories":[15300],"tags":[8795]}