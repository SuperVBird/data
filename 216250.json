{"id":216250,"link":"https://chinadigitaltimes.net/chinese/2012/03/阮一峰-基于用户投票的排名算法（四）：牛顿冷/","date":"2012-03-19T10:47:27Z","modified":"2012-03-19T10:47:27Z","title":"阮一峰 | 基于用户投票的排名算法（四）：牛顿冷却定律","content":"<p><p>这个系列的前三篇，介绍了<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/02/ranking_algorithm_hacker_news.html\">Hacker News</a>，<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_reddit.html\">Reddit</a>和<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_stack_overflow.html\">Stack Overflow</a>的排名算法。</p>\n<p>今天，讨论一个更一般的数学模型。</p>\n<p>这个系列的每篇文章，都是可以分开读的。但是，为了保证所有人都在同一页上，我再说一下，到目前为止，<strong>我们用不同方法，企图解决的都是同一个问题：根据用户的投票，决定最近一段时间内的&#8221;热文排名&#8221;。</strong></p>\n<p>你可能会觉得，这是一个全新的课题，伴随着互联网而产生，需要全新的方法来解决。但是，实际上不是。我们可以把&#8221;热文排名&#8221;想象成一个&#8221;自然冷却&#8221;的过程：</p>\n<blockquote>\n<p>　　（1）任一时刻，网站中所有的文章，都有一个&#8221;当前温度&#8221;，温度最高的文章就排在第一位。</p>\n<p>　　（2）如果一个用户对某篇文章投了赞成票，该文章的温度就上升一度。</p>\n<p>　　（3）随着时间流逝，所有文章的温度都逐渐&#8221;冷却&#8221;。</p>\n<p>　　<img src=\"http://image.beekka.com/blog/201203/bg2012031504.jpg\" /></p>\n</blockquote>\n<p>这样假设的意义，在于我们可以照搬物理学的冷却定律，使用现成的公式，建立&#8221;温度&#8221;与&#8221;时间&#8221;之间的函数关系，轻松构建一个<a rel=\"nofollow\" href=\"http://en.wikipedia.org/wiki/Exponential_decay\">&#8220;指数式衰减&#8221;</a>（Exponential decay）的过程。</p>\n<p><img src=\"http://image.beekka.com/blog/201203/bg2012031501.png\" /></p>\n<p>伟大的物理学家牛顿，早在17世纪就提出了温度冷却的数学公式，被后人称作<a rel=\"nofollow\" href=\"http://episte.math.ntu.edu.tw/applications/ap_cooling/index.html\">&#8220;牛顿冷却定律&#8221;</a>（Newton&#8217;s Law of Cooling）。我们就用这个定律构建排名算法。</p>\n<p><img src=\"http://image.beekka.com/blog/201203/bg2012031502.jpg\" /></p>\n<p>&#8220;牛顿冷却定律&#8221;非常简单，用一句话就可以概况：</p>\n<blockquote>\n<p><strong>物体的冷却速度，与其当前温度与室温之间的温差成正比。</strong></p>\n</blockquote>\n<p>写成数学公式就是：</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T'(t)%3D-%5Calpha%20(T(t)-H)&#038;chs=60\" /></p>\n<p>其中，</p>\n<blockquote>\n<p>　　- T(t)是温度（T）的时间（t）函数。微积分知识告诉我们，温度变化（冷却）的速率就是温度函数的导数T'(t)。</p>\n<p>　　- H代表室温，T(t)-H就是当前温度与室温之间的温差。由于当前温度高于室温，所以这是一个正值。</p>\n<p>　　- 常数α（α>0）表示室温与降温速率之间的比例关系。前面的负号表示降温。不同的物质有不同的α值。</p>\n</blockquote>\n<p>这是一个微分方程，为了计算当前温度，需要求出T(t)的函数表达式。</p>\n<p>第一步，改写方程，然后等式两边取积分。</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=%5Cfrac%7BT'(t)%7D%7BT(t)-H%7D%3D-%5Calpha&#038;chs=80\" /></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=%5Cint%5Cfrac%7BT'(t)%7D%7BT(t)-H%7D%5C%2Cdt%3D%5Cint(-%5Calpha)%5C%2Cdt&#038;chs=80\" /></p>\n<p>第二步，求出这个积分的解（c为常数项）。</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=ln(T(t)-H)%3D-%5Calpha%20t%2Bc&#038;chs=40\" /></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T(t)-H%3De%5E%7B(-%5Calpha%20t%2Bc)%7D&#038;chs=40\" /></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T(t)%3DH%2BCe%5E%7B-%5Calpha%20t%7D&#038;chs=40\" /></p>\n<p>第三步，假定在时刻t<sub>0</sub>，该物体的温度是T(t<sub>0</sub>)，简写为T<sub>0</sub>。代入上面的方程，得到</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T_%7B0%7D%3DH%2BCe%5E%7B-%5Calpha%20t_%7B0%7D%7D&#038;chs=40\" /></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=C%3D(T_%7B0%7D-H)e%5E%7B%5Calpha%20t_%7B0%7D%7D&#038;chs=40\" /></p>\n<p>第四步，将上一步的C代入第二步的方程。</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T%3DH%2B(T_%7B0%7D-H)e%5E%7B-%5Calpha(t-t_%7B0%7D)%7D&#038;chs=40\" /></p>\n<p>假定室温H为0度，即所有物体最终都会&#8221;冷寂&#8221;，方程就可以简化为</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=T%3DT_%7B0%7De%5E%7B-%5Calpha(t-t_%7B0%7D)%7D&#038;chs=40\" /></p>\n<p>上面这个方程，就是我们想要的最终结果：</p>\n<blockquote>\n<p>　　<strong>本期温度 = 上一期温度 x exp(-(冷却系数) x 间隔的小时数)</strong></p>\n</blockquote>\n<p>将这个公式用在&#8221;排名算法&#8221;，就相当于（假定本期没有增加净赞成票）</p>\n<blockquote>\n<p>　　<strong>本期得分 = 上一期得分 x exp(-(冷却系数) x 间隔的小时数)</strong></p>\n</blockquote>\n<p>其中，&#8221;冷却系数&#8221;是一个你自己决定的值。如果假定一篇新文章的初始分数是100分，24小时之后&#8221;冷却&#8221;为1分，那么可以计算得到&#8221;冷却系数&#8221;约等于0.192。如果你想放慢&#8221;热文排名&#8221;的更新率，&#8221;冷却系数&#8221;就取一个较小的值，否则就取一个较大的值。</p>\n<p><a rel=\"nofollow\" href=\"http://www.wolframalpha.com/input/?i=plot%28100e%5E%28-0.19t%29%2C100e%5E%28-0.10t%29%2C100e%5E%28-0.50t%29%29+where+t%3D0..24\"><img src=\"http://image.beekka.com/blog/201203/bg2012031503.jpg\" /></a></p>\n<p>[参考文献]</p>\n<p>　　*　<a rel=\"nofollow\" href=\"http://www.evanmiller.org/rank-hotness-with-newtons-law-of-cooling.html\">Rank Hotness With Newton&#8217;s Law of Cooling</a></p>\n<p>（完）</p>\n<div>\n<h3>文档信息</h3>\n<ul>\n<li>版权声明：自由转载-非商用-非衍生-保持署名 | <a rel=\"nofollow\" href=\"http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh\">Creative Commons BY-NC-ND 3.0</a></li>\n<li>原文网址：<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_newton_s_law_of_cooling.html\">http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_newton_s_law_of_cooling.html</a></li>\n<li>最后修改时间：2012年3月16日 00:47</li>\n<li>付费支持：<a rel=\"nofollow\" href=\"https://mai.alipay.com/p.htm?id=2012010602227616\"><img alt=\"支付宝担保交易\" src=\"http://chinadigitaltimes.net/chinese/files/2012/03/3a976ef2rmb_32.png.png\" /></a> | <a rel=\"nofollow\" href=\"https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&#038;business=yifeng.ruan@gmail.com&#038;currency_code=USD&#038;amount=2.99&#038;return=http://www.ruanyifeng.com/thank.html&#038;item_name=Ruan%20YiFeng's%20Blog&#038;undefined_quantity=1&#038;no_note=0\"><img alt=\"paypal\" src=\"http://chinadigitaltimes.net/chinese/files/2012/03/5ca83e43dollar_32.png.png\" /></a> </li>\n</ul>\n</div>\n<div>\n<p><a rel=\"nofollow\" href=\"http://yipinzao.com/\"><img src=\"http://www.ruanyifeng.com/blog/images/ad_yipinzao.jpg\" /></a></p>\n</div>\n<p><img src=\"http://chinadigitaltimes.net/chinese/files/2012/03/21969c95g2012031504.jpg-150x150.jpg\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"450\" height=\"309\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=750556\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"750556\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":1004,"categories":[9203],"tags":[5908,9400,8795]}