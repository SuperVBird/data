{"id":240729,"link":"https://chinadigitaltimes.net/chinese/2012/07/翻墙-解决dropbox无法实时更新的问题/","date":"2012-07-18T10:15:18Z","modified":"2012-07-18T10:15:18Z","title":"翻墙 | 解决Dropbox无法实时更新的问题","content":"<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://briteming.blogspot.com/2012/07/dropbox.html\">http://briteming.blogspot.com/2012/07/dropbox.html</a></p>\n<div></div>\n<div><span>本文背景是，中国到dropbox的 http连接会被重置，但是https连接不受影响。如果背景改变了，则本文失效。本文主题是让dropbox客户端的http请求经socks代理访问 dropbox服务器，而https请求不经代理直接访问，用这种方法来解决Dropbox客户端目前无法实时更新的问题。</span></p>\n<p><span>现象：在国内的多个电脑客户端使用同一个Dropbox帐号登录，实现协同办公等操作，但是一台电脑更新文件后，无法实时同步到其他电脑客户端。而在国外的网络环境没有这种现象.</span><br /> <span>原因：目前在国内，dropbox被关键字屏蔽（Wildcard: .<a rel=\"nofollow\" target=\"_blank\" href=\"http://dropbox.com\">dropbox.com</a>），但是客户端还能正常使用，因为客户端和服务器之间使用的是https加密传输。但只有一处是没有使用https的，就是 <a rel=\"nofollow\" target=\"_blank\" href=\"http://stork47.dropbox.com\">stork47.dropbox.com</a>（笔者是这个地址，其他地方可能不一样）。这个服务器负责将服务器端（或其他客户端）发生的文件更新通知到其他客 户端（笔者猜的，但应该差不多），然后其他客户端才会发起https请求去和服务器同步这些文件。实际中，是客户端每60秒向 <a rel=\"nofollow\" target=\"_blank\" href=\"http://stork47.dropbox.com\">stork47.dropbox.com</a>查询一次，看是否有文件需要更新。因为该请求没有使用https连接，导致连接一直被RESET，所以某台客户端 的更新无法实时反映到其他客户端。</span></p>\n<p><span>因为一般人可能没有这个需求，所以没多少人关注这个课题。像我以前也只是在家里和公司同步一些文件而 已，没有实时更新的必要。有强烈需求的人，就设置让客户端全程走代理，可以解决上述问题，缺点是文件的更新速度受代理服务器速度的影响，大多数情况下没有 直接连接的速度快。还有一部分人当需要更新时，直接重启客户端（甚至为此写了个脚本），因为客户端只在启动时才使用https连接检查更新，这样做的缺点 显而易见。</span></p>\n<p><span>解决Dropbox无法实时更新的问题</span></p>\n<p><span>解决方法：最近用privoxy，发现它可以做到分流http和https，于是试验了一下，果然可以分流dropbox的客户端请求了。就是前面说 的，让http 请求走代理，而https请求不走。这样即满足了实时更新的需求，又兼顾了更新速度，可谓智能代理了。privoxy还有不少替代方案笔者没有试过的，比 如polipo之类。以下是操作步骤。</span></p>\n<p><span>1，需要准备的东西：dropbox客户端、代理软件、privoxy。该方案应该与平台无关，但是笔者只在windows 7下试验过。</span></p>\n<p><span>2，打开privoxy的配置文件config.txt，在最后面添加这几行：</span></p>\n<p><span>#   for dropbox: http –> SOCKS Proxy(19841), https –> direct</span><br /> <span>forward-socks5   .<a rel=\"nofollow\" target=\"_blank\" href=\"http://dropbox.com\">dropbox.com</a>             <a rel=\"nofollow\" target=\"_blank\" href=\"http://127.0.0.1:19841\">127.0.0.1:19841</a> .</span><br /> <span>forward          .<a rel=\"nofollow\" target=\"_blank\" href=\"http://dropbox.com:443\">dropbox.com:443</a>         .</span></p>\n<p><span>注意将19841修改为你自己的代理软件的端口。如果你的代理软件不是socks类型的，那么就不是加上面的几行，而是加这几行：</span></p>\n<p><span>#   for dropbox: http –> HTTP Proxy(19842), https –> direct</span><br /> <span>forward          .<a rel=\"nofollow\" target=\"_blank\" href=\"http://dropbox.com\">dropbox.com</a>             <a rel=\"nofollow\" target=\"_blank\" href=\"http://127.0.0.1:19842\">127.0.0.1:19842</a></span><br /> <span>forward          .<a rel=\"nofollow\" target=\"_blank\" href=\"http://dropbox.com:443\">dropbox.com:443</a>         .</span></p>\n<p><span>注意好多地方有半角的.号，不要弄丢了。</span></p>\n<p><span>3，启动privoxy，将dropbox的代理设置为HTTP 127.0.0.1:8118，就OK了.</span> </div>\n<div>请点击<a rel=\"nofollow\" target=\"_blank\" href=\"https://mycdt4.info/chinese/\">https://mycdt4.info/chinese/</a>，穿墙访问《中国数字时代》。《中国数字时代》开通IPv6，欢迎穿墙阅读。翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\n\n\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5500297126185736776-6609252761021469499?l=www.chinagfw.org\" alt=\"\" /></div>\n</p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?hl=zh-CN&#038;formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"510\" height=\"328\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=2ea93c5b7b\">\n定期获得翻墙信息？<a href=\"http://eepurl.com/msuvD\">请电邮订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1005,"categories":[18269,15300],"tags":[8795,8817]}