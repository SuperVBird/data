{"id":288137,"link":"https://chinadigitaltimes.net/chinese/2013/04/翻墙-给squid代理服务器加上密码/","date":"2013-04-07T23:30:47Z","modified":"2013-04-07T23:30:47Z","title":"翻墙 | 给squid代理服务器加上密码","content":"<p><span></p>\n<p>真的感觉自己挺失败的,代理服务器第二次被人家盗用, 都怪自己不小心, 没把服务器的防火墙加到开机启动, 同时squid的也没有去加密码认证</p>\n<p>感觉还是要细心, 运维就是要小心细心, 于是今中午抽出点时间给squid设定下密码这样以后即使防火墙忘记关闭,也不至于被人家白白盗用去干坏事</p>\n<p>squid的配置如下:</p>\n<div>\n<table>\n<tbody>\n<tr>\n<td>\n<pre>   # Recommended minimum configuration<span>:</span>  #  #  # INSERT YOUR OWN RULE<span>(</span>S<span>)</span> HERE TO ALLOW ACCESS FROM YOUR CLIENTS  #     # Example rule allowing access from your local networks.  # Adapt localnet in the ACL section to list your <span>(</span>internal<span>)</span> IP networks  # from where browsing should be allowed  visible_hostname ad1  acl ip1  myip 192.168.1.50  tcp_outgoing_address 192.168.1.50 ip1     # Squid normally listens to port <span>3128</span>  http_port 192.168.1.50<span>:</span><span>54321</span>     # Uncomment and adjust the following to add a disk cache directory.           <span>request_header_access</span> Allow allow all  request_header_access Authorization allow all  request_header_access WWW<span>-</span>Authenticate allow all  request_header_access Proxy<span>-</span>Authorization allow all  request_header_access Proxy<span>-</span>Authenticate allow all  request_header_access Cache<span>-</span><span>Control</span> allow all  request_header_access Content<span>-</span>Encoding allow all  request_header_access Content<span>-</span>Length allow all  request_header_access Content<span>-</span>Type allow all  request_header_access <span>Date</span> allow all  request_header_access Expires allow all  request_header_access Host allow all  request_header_access If<span>-</span>Modified<span>-</span>Since allow all  request_header_access Last<span>-</span>Modified allow all  request_header_access Location allow all  request_header_access Pragma allow all  request_header_access Accept allow all  request_header_access Accept<span>-</span>Charset allow all  request_header_access Accept<span>-</span>Encoding allow all  request_header_access Accept<span>-</span>Language allow all  request_header_access Content<span>-</span>Language allow all  request_header_access Mime<span>-</span>Version allow all  request_header_access Retry<span>-</span>After allow all  request_header_access Title allow all  request_header_access <span>Connection</span> allow all  request_header_access Proxy<span>-</span><span>Connection</span> allow all  request_header_access User<span>-</span>Agent allow all  request_header_access Cookie allow all  auth_param basic program <span>/</span>usr<span>/</span>local<span>/</span>squid<span>/</span>libexec<span>/</span>ncsa_auth <span>/</span>usr<span>/</span>local<span>/</span>squid<span>/</span>libexec<span>/</span>passwd  acl auth_user proxy_auth REQUIRED  http_access allow auth_user</pre>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>当然这个squid是自己编译安装的,网上的都是使用yum 要么是apt-get install 安装的 所以路径不同,我们的 auth_param 路径实在/usr/local/squid/libexec 中</p>\n<p>后面的用户名认证文件我们使用httpd-tools 工具生成的 在centos上可以使用</p>\n<div>\n<table>\n<tbody>\n<tr>\n<td>\n<pre>yum <span>-</span>y install httpd<span>-</span>tools</pre>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>然后:<br />接着生成密码文件：</p>\n<div>\n<table>\n<tbody>\n<tr>\n<td>\n<pre>htpasswd <span>-</span>c <span>/</span>usr<span>/</span>local<span>/</span>squid<span>/</span>libexec<span>/</span>passwd user1</pre>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>接下来输入二次密码，确认。</p>\n<p>最后就ok了 , 以后做任何事情一定要小心,要细心; 相信自己随着时间 会慢慢老练起来!</p>\n<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"https://blog.4u45.com/?p=663\">https://blog.4u45.com/?p=663</a></span></p>\n<div>获取最新穿墙软件？请发电邮（最好用gmail）到：cdtcaonima@gmail.com。《中国数字时代》开通IPv6，欢迎穿墙阅读。翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\n\n\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a></div>\n</p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?hl=zh-CN&#038;formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"510\" height=\"328\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=b4fd4ae247\">\n<a href=\"http://eepurl.com/mstlf\">墙外新闻实时更新 欢迎订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1005,"categories":[18269,15300],"tags":[7775]}