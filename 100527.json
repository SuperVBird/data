{"id":100527,"link":"https://chinadigitaltimes.net/chinese/2010/08/使用grep恢复被删文件内容/","date":"2010-08-25T03:55:28Z","modified":"2010-08-25T03:55:28Z","title":"使用grep恢复被删文件内容","content":"<p><p>来自: <a href=\"http://www.feedzshare.com/b/557567/2\">酷壳 &#8211; CoolShell.cn &#8211; FeedzShare</a>  <br />\n<br />发布时间:2010年08月24日,  已有 8 人推荐 </p>\n<hr>\n<div>\n<p>在Unix/Linux下，最危险的命令恐怕就属rm命令了，每次在root下使用这个命令的时候，我都要盯着命令行看上几分钟才敢把回车敲下去。以前，看到同事在脚本中使用rm命令 —— <code>rm {$App_Dir}/*</code> 。因为脚本没有判断变量$App_Dir是否为空，结果，在一次用root操作的时候，整个操作系统一下就不见了，还好只是开发机。从此，我们大家都再也不敢使用rm命令了。</p>\n<p>这里给大家介绍一个小技巧用来恢复一些被rm了的文件中的数据。我们知道，rm命令其实并不是真正的从物理上删除文件内容，只过不把文件的inode回收了，其实文件内容还在硬盘上。所以，如果你不小删除了什么比较重要的程序配置文件的时候，我们完全可以用grep命令在恢复，下面是一个恢复示例：</p>\n<pre>grep -a -B 50 -A 60 &#39;some string in the file&#39; /dev/sda1 > results.txt</pre>\n<p>说明：</p>\n<ul>\n<li>关于grep的-a意为–binary-files=text，也就是把二进制文件当作文本文件。</li>\n<li>-B和-A的选项就是这段字符串之前几行和之后几行。</li>\n<li>/dev/sda1，就是硬盘设备，</li>\n<li>> results.txt，就是把结果重定向到results.txt文件中。</li>\n</ul>\n<p>如果你幸运的话，你就可以看到被恢复的内容了。这正是Unix的简单哲学（详见《<a href=\"http://coolshell.cn/articles/2324.html\">Unix传奇下篇</a>》）——<strong> 所有的设备都是文件</strong>。</p>\n<p>当然，我还是建议你把root用户的rm的命令用alias换成别一个脚本，那个脚本会帮你把删除的文件放到某个地方。</p>\n<p><img src=\"http://coolshell.cn/?ak_action=api_record_view&#038;id=2822&#038;type=feed\" alt=\"\" /></p>\n<h3>相关文章</h3>\n<ul>\n<li>2010年04月09日 &#8212; <a href=\"http://coolshell.cn/articles/2324.html\" title=\"Unix传奇(下篇)\">Unix传奇(下篇)</a></li>\n<li>2009年08月16日 &#8212; <a href=\"http://coolshell.cn/articles/1272.html\" title=\"操作系统航空公司\">操作系统航空公司</a></li>\n<li>2009年06月21日 &#8212; <a href=\"http://coolshell.cn/articles/1042.html\" title=\"Linux/Unix 新手和专家教程\">Linux/Unix 新手和专家教程</a></li>\n<li>2009年06月16日 &#8212; <a href=\"http://coolshell.cn/articles/1044.html\" title=\"高级Unix命令\">高级Unix命令</a></li>\n<li>2009年06月12日 &#8212; <a href=\"http://coolshell.cn/articles/1032.html\" title=\"Unix 40年：Unix年鉴\">Unix 40年：Unix年鉴</a></li>\n<li>2009年06月11日 &#8212; <a href=\"http://coolshell.cn/articles/1023.html\" title=\"Unix 40年：昨天，今天和明天 \">Unix 40年：昨天，今天和明天 </a></li>\n<li>2010年07月26日 &#8212; <a href=\"http://coolshell.cn/articles/2724.html\" title=\"计算机编程简史图\">计算机编程简史图</a></li>\n</ul>\n</div>\n<p><img src=\"http://img.tongji.linezing.com/1017243/tongji.gif\" /><img src=\"http://img.tongji.linezing.com/997968/tongji.gif\" /></p>\n<p>“要翻墙，<a href=\"http://bieyouyongxin.info\" target=\"_blank\">用赛风”</a>.</p>\n","author":176,"categories":[1],"tags":[8800]}