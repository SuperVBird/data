{"id":273528,"link":"https://chinadigitaltimes.net/chinese/2013/01/编程随想-如何隐藏你的踪迹，避免跨省追捕7：用/","date":"2013-01-08T11:15:12Z","modified":"2013-01-08T11:15:12Z","title":"编程随想 | 如何隐藏你的踪迹，避免跨省追捕[7]：用虚拟机隐匿公网IP（配置图解）","content":"<p>　　4天前发布了《用虚拟机隐匿公网IP》，好些个读者到博客留言，抱怨俺讲得太简单。缺少傻瓜化的、带截图的配置教程。俺恭敬不如从命，今天再发一篇《用虚拟机隐匿公网IP（配置图解）》，竭尽所能，写得尽量傻瓜化。<br />\n　　至于前面那一篇，标题修改为《用虚拟机隐匿公网IP（原理介绍）》。<br />\n　　顺便说一下：<br />\n　　前面那篇发到 G+ 上，貌似被顶到 G+ 热门榜，转发数很多。看来有不少网友关注&#8221;隐匿身份&#8221;这个话题 :) 所以俺今后会多花点时间，普及这方面的相关常识。</p>\n<h2>★准备工作</h2>\n<p></p>\n<h3>◇思想上的准备</h3>\n<p>\n　　首先，如果你对虚拟机软件不太熟悉，<b><u>一定要先看完</u></b>俺之前写的《<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/10/system-vm-0.html\">扫盲操作系统虚拟机</a>》。<br />\n　　其次，再把本系列的前一篇博文（链接在&#8221;<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2013/01/howto-cover-your-tracks-6.html\">这里</a>&#8220;）<b><u>认真看完</u></b>。那篇博文是介绍&#8221;虚拟机隐匿公网IP&#8221;的原理，配有精美示意图 :)</p>\n<h3>◇虚拟机软件的准备</h3>\n<p>\n　　既然要用虚拟机隐匿公网IP，当然要先把虚拟机软件准备好。假如你不晓得该选哪种虚拟机软件，请看俺之前的一篇博文（请翻墙看&#8221;<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/11/system-vm-3.html\">这里</a>&#8220;），专门介绍虚拟机软件的选择。<br />\n　　本文主要拿 VMware Workstation（以下简称 VMware）和 VirtualBox 来介绍。</p>\n<h3>◇代理软件的准备</h3>\n<p>\n　　先声明一下，本文提到的&#8221;代理&#8221;一词是广义的，包括普通代理、VPN、多重代理、等。<br />\n　　由于本教程是拿虚拟机跟代理软件进行组合搭配，所以你还得懂得使用代理软件。这点应该不难——只要你有翻墙的经历，你就已经在同&#8221;代理软件&#8221;打交道了。如果你从来没玩过翻墙，请先学习俺博客上的诸多翻墙教程（包括：TOR、I2P、赛风、世界通、自由门、无界、等等）。<br />\n　　关于代理的类型，俺强烈建议用<b>多重代理</b>（教程在&#8221;<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/03/howto-cover-your-tracks-5.html\">这里</a>&#8220;，需翻墙）。为啥捏？如果你对隐匿性的要求不高，根本都不需要看本教程。你来看本教程，就说明你对隐匿性有较高的要求。既然如此，当然要用多重代理啦——这可以大大增加逆向追踪的难度。<br />\n　　注意事项：<span><b>要确保你用的代理软件，是监听在 0.0.0.0 地址，而不是监听在 127.0.0.1 地址</b></span>。如果代理软件只监听在 127.0.0.1 地址，那么其它虚拟机的网络软件是无法连接到这个监听端口的。如何看代理软件监听在哪个地址上捏？可以在 Windows 的命令行窗口（就是那黑窗口）中执行如下命令，就可以看到当前系统中开启的所有监听端口以及该监听绑定的地址。<br />\n<b>netstat -an | find &#8220;LISTEN&#8221;</b></p>\n<h3>◇关于操作系统的说明</h3>\n<p>\n　　本教程适用于目前的各种主流操作系统，包括但不限于 Windows、Linux、Mac OS X &#8230;&#8230;<br />\n　　考虑到目前 Windows 系统的用户占绝大多数，本教程拿 Windows 系统来说事儿。希望 Linux 系统和 Mac OS X 系统的用户别怨俺偏心。<br />\n　　注意事项：<span><b>要特别小心真实系统和虚拟系统的防火墙设置</b></span>。很多人是因为防火墙没设好，导致代理无法连通。</p>\n<h2>★真实系统（Host OS）的物理网卡</h2>\n<p>\n　　先跟大伙儿说一下：今天这个教程跟物理网卡<b>没有</b>半毛钱关系。跟你电脑上装了多少块物理网卡，<b>也没有</b>半毛钱关系。在本文后续的介绍中，<b>不会</b>再涉及到物理网卡。待会儿在配置代理的时候，也<b>不会</b>再涉及物理网卡上的 IP 地址。切记！<br />\n　　另外，今天这个教程，跟你用的上网方式也没有关系。不论你是在公司上网还是在家用宽带，本教程都适用。</p>\n<h2>★真实系统（Host OS）的虚拟网卡</h2>\n<p>\n　　（<b>这部分是重点，注意看喽！</b>）<br />\n　　一旦你安装完虚拟机软件，那么你的操作系统中就会多出新的虚拟网卡和虚拟子网。下面俺根据 VMware 和 VirtualBox 分别说明。</p>\n<h3>◇VMware</h3>\n<p>\n　　每次安装 VMware，新增加的虚拟子网，网络地址都可能会不同，所以俺多费点口水。<br />\n　　首先到 Windows 控制面板的网络连接看一下，如果看到下图，就这说明 VMware 已经帮你加入了2个虚拟网卡，这俩网卡分别位于 NAT 虚拟子网和 Host-Only 虚拟子网。<br />\n<img src=\"http://lh3.googleusercontent.com/I0BZO21bRYuinYFgRO87fB-ZY4Bac3L7orMMxn7m9m7y7ZfOvn4AazIltGFDj41JWAbrFZp5ah3TdbrwI_IPTEhWVEyg81iQp3BdKLhAGIv9KcZdy5TuuzlM6KM\" alt=\"不见图 请翻墙\" /></p>\n<p>　　然后，你到 VMware 主菜单上点 &#8220;Edit&#8221; 菜单，然后再点 &#8220;Virtual Network Editor&#8221; 菜单，会出现虚拟子网的对话框，通过该对话框可以看到 VMware 创建的所有虚拟子网。你会看到好多个虚拟子网，咱只要关心其中两个——分别 Type 为 Host-Only 和 Type 为 NAT 的。然后，把这两个子网的 &#8220;Subnet Address&#8221; 分别记下来（<b>千万别把这俩记混了</b>），待会儿要用到。截图如下<br />\n<img src=\"http://lh6.googleusercontent.com/z-D7eOmA1xYjGQcdPZ9cSV7RSl8nGWbkls8-_fUc1fHghH7YqcI1jvZpzO77HnXw5btC9r6wByLjf_dvL96Kzlibe6XJHs6-JhcFQ39WhZBdhcrGCgk_07beKK0\" alt=\"不见图 请翻墙\" /></p>\n<p>（请注意，上述截图中列出的都是虚拟子网的<b>网络地址</b>，表示的是整个子网，所以最后一位是 0 ）</p>\n<h3>◇VirtualBox</h3>\n<p>\n　　每次安装 VirtualBox 的时候，它创建的虚拟子网，网络地址总是一样的，所以 VirtualBox 的操作比较简单。<br />\n　　对于 NAT 模式，默认的虚拟子网总是 <b>10.0.2.0</b>；对于 Host-Only 模式，默认的虚拟子网总是 <b>192.168.56.0</b>（请注意，这两个是虚拟子网的<b>网络地址</b>，表示的是整个子网，所以最后一位是 0 ）<br />\n　　牢记这俩子网的网络地址（<b>千万别把这俩记混了</b>），待会儿要用到。</p>\n<h2>★单虚拟机方案</h2>\n<p></p>\n<h3>◇安装虚拟系统（Guest OS）</h3>\n<p>\n　　如何在虚拟机软件中安装 Guest OS，《<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/10/system-vm-0.html\">扫盲操作系统虚拟机</a>》系列教程已经有详细的操作图解，此处不再啰嗦。</p>\n<h3>◇虚拟系统的网卡配置</h3>\n<p>\n　　（<b>这部分是重点，看仔细喽！</b>）<br />\n　　首先，你要在虚拟机软件中设置该 &#8220;虚拟系统A&#8221; 的网卡模式，要设置为 <b>Host-Only</b>。<br />\n　　其次，要进入 &#8220;虚拟系统A&#8221;，到&#8221;控制面板&#8221;的&#8221;网络连接&#8221;里，找到那块网卡，右键菜单点&#8221;属性&#8221;，再点&#8221;TCP/IP&#8221;的属性，会出现如下截图<br />\n<img src=\"http://lh3.googleusercontent.com/bS3_NN5upSDaEuUgOTyDC38X1Q8N5Njyorp0CSatovD1CTq5y6lPkn0fOBQXUZqH6dwPAUYeeHj9pVqUVkmf6sIig18AfCRmVldSeMKoW2nVWwNdi7s0WO3EMcA\" alt=\"不见图 请翻墙\" /></p>\n<p><b>IP 地址</b><br />\n（<b>这步一定要小心，别填错了</b>）<br />\nIP 地址一共四段，头三段分别填写 <b>Host-Only</b> 子网的网络地址的头三个数字（请回顾刚才的章节——★真实系统的虚拟网卡）。<br />\nIP 地址的第四段，你可以填 <b>2到254</b> 之间的任何一个数。<br />\n<b>子网掩码</b><br />\n填写 255.255.255.0<br />\n<b>默认网关</b><br />\n不用填<br />\n<b>DNS</b><br />\n不用填</p>\n<p>　　这块 Host-Only 网卡配好之后，为了验证你是否配置成功，可以执行如下步骤验证：<br />\n进入 &#8220;虚拟系统&#8221;，用 ping 命令 ping 一下真实系统的那块 Host-Only 网卡的 IP 地址。如果能 ping 得到就说明你配对了。</p>\n<h3>◇代理软件的安装</h3>\n<p>\n　　在单虚拟机方案中，代理直接安装在 Host OS 里面。关于代理软件的安装，就不用再啰嗦了吧？</p>\n<h3>◇上网软件的配置</h3>\n<p>\n　　（<b>这部分也是重点，看仔细喽！</b>）<br />\n　　为网络软件配置代理的时候，通常要填写代理的 IP 地址和端口号。端口号通常不会搞错。因为每一款代理软件开启的端口号是固定的。但是 IP 地址常常会填错。很多人就是栽在这一步。<br />\n　　填写代理的 IP 地址，<b>千万不能</b>填 127.0.0.1，因为这个地址表示本机，也就是 Guest OS 自己。<br />\n　　<b>正确的写法</b>是：填写真实系统的那个 <b>Host-Only</b> 网卡的 IP。<br />\n　　这个 IP 地址一共四段，头三段分别填写 <b>Host-Only</b> 子网的网络地址的头三个数字（请回顾刚才的章节——★真实系统的虚拟网卡）；第四段填 <b>1</b><br />\n　　俺以IE浏览器为例，截图如下<br />\n<img src=\"http://lh3.googleusercontent.com/ywn99XmncvnxcYN2hOcLND3IBzGMlA1sxqm9ovOmiv7tg3yqtsc3c5S1VwkddNOuCivOxCo0Agc04p4UBB6TZybIoU2tXdSOi1S_Yn7XrmCNTAfdcBjlACOHMDI\" alt=\"不见图 请翻墙\" /></p>\n<h2>★双虚拟机方案</h2>\n<p></p>\n<h3>◇安装两个虚拟系统（Guest OS）</h3>\n<p>\n　　如何在虚拟机软件中安装 Guest OS，《<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/10/system-vm-0.html\">扫盲操作系统虚拟机</a>》系列教程已经有详细的操作图解，此处不再啰嗦。<br />\n　　要使用双虚拟机方案，你需要装<b>两套</b>虚拟系统。</p>\n<h3>◇虚拟系统A 的网卡配置</h3>\n<p>\n　　首先，你要在虚拟机软件中设置该 &#8220;虚拟系统A&#8221; 的网卡模式，要设置为 <b>Host-Only</b>。<br />\n　　其次，要进入 &#8220;虚拟系统A&#8221;，到&#8221;控制面板&#8221;的&#8221;网络连接&#8221;里，找到那块网卡，点属性，会出现如下截图<br />\n<img src=\"http://lh3.googleusercontent.com/bS3_NN5upSDaEuUgOTyDC38X1Q8N5Njyorp0CSatovD1CTq5y6lPkn0fOBQXUZqH6dwPAUYeeHj9pVqUVkmf6sIig18AfCRmVldSeMKoW2nVWwNdi7s0WO3EMcA\" alt=\"不见图 请翻墙\" /></p>\n<p><b>IP 地址</b><br />\n（<b>这步一定要小心，别填错了</b>）<br />\nIP 地址一共四段，头三段分别填写 <b>Host-Only</b> 子网的网络地址的头三个数字（请回顾刚才的章节——★真实系统的虚拟网卡）。<br />\nIP 地址的第四段，你可以填 <b>2到254</b> 之间的任何一个数。<br />\n<b>子网掩码</b><br />\n填写 255.255.255.0<br />\n<b>默认网关</b><br />\n不用填<br />\n<b>DNS</b><br />\n不用填</p>\n<p>　　这块 Host-Only 网卡配好之后，为了验证你是否配置成功，可以执行如下步骤验证：<br />\n进入 &#8220;虚拟系统A&#8221;，用 ping 命令 ping 一下真实系统的那块 Host-Only 网卡的 IP 地址。如果能 ping 得到就说明你配对了。</p>\n<h3>◇虚拟系统B 的网卡配置</h3>\n<p>\n　　&#8221;虚拟系统B&#8221;要配置两块网卡，<span><b>这部分非常非常容易搞错，一定要看仔细喽！</b></span></p>\n<p><b>第1步</b><br />\n刚装好的 &#8220;虚拟系统B&#8221;，默认已经有一块网卡了。你先把这块网卡的网卡模式，设置为 <b>NAT</b>。</p>\n<p><b>第2步</b><br />\n进入 &#8220;虚拟系统B&#8221;，到&#8221;控制面板&#8221;的&#8221;网络连接&#8221;里，找到那块网卡，右键菜单点&#8221;属性&#8221;，再点&#8221;TCP/IP&#8221;的属性，会出现如下截图<br />\n<img src=\"http://lh3.googleusercontent.com/hc60D2QGAJWQkllix3-vIwuIb7pbhsSS1rMLGhTtTAJbyatY-Kh8DzFx_dE2-MxIuraN-6b-SxtEO_JMB69wcrNR7GmV--cibnHFeyZ9v2nFBT1sMvDb3Or85JI\" alt=\"不见图 请翻墙\" /></p>\n<p><b>IP 地址</b><br />\n（<b>这步一定要小心，别填错了</b>）<br />\nIP 地址一共四段，头三段分别填写 <b>NAT</b> 子网的网络地址的头三个数字（请回顾刚才的章节——★真实系统的虚拟网卡）。<br />\nIP 地址的第四段，你可以填 <b>3到254</b> 之间的任何一个数。<br />\n<b>默认网关</b><br />\n（<b>这步也要小心，别填错了</b>）<br />\n默认网关的地址也是4段，头三段就照抄刚才 IP 地址的头3个数字。第4个数字填写 <b>2</b>（不论是 VMware 还是 VirtualBox 都填 2）<br />\n<b>DNS</b><br />\n此处填写你常用的 DNS 服务器，俺个人建议填 Google 的那俩（8.8.8.8 和 8.8.4.4）<br />\n<b>子网掩码</b><br />\n填写 255.255.255.0</p>\n<p>　　这块 NAT 网卡配好之后，为了验证你是否配置成功。可以在 &#8220;虚拟系统B&#8221; 里面开一个浏览器（不设代理），访问一下互联网。如果能访问，说明这块 NAT 网卡 OK 了。</p>\n<p><b>第3步</b><br />\n打开虚拟系统的设置对话框，再添加一块网卡了。（如何加第二块网卡，请看《<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2012/12/system-vm-5.html\">扫盲操作系统虚拟机</a>》教程）然后把这块网卡的网卡模式，设置为 <b>Host-Only</b>。</p>\n<p><b>第4步</b></p>\n<p>　　进入 &#8220;虚拟系统B&#8221;，到&#8221;控制面板&#8221;的&#8221;网络连接&#8221;里，找到新添加的<b>第二块</b>网卡，右键菜单点&#8221;属性&#8221;，再点&#8221;TCP/IP&#8221;的属性，会出现如下截图<br />\n<img src=\"http://lh3.googleusercontent.com/bS3_NN5upSDaEuUgOTyDC38X1Q8N5Njyorp0CSatovD1CTq5y6lPkn0fOBQXUZqH6dwPAUYeeHj9pVqUVkmf6sIig18AfCRmVldSeMKoW2nVWwNdi7s0WO3EMcA\" alt=\"不见图 请翻墙\" /></p>\n<p><b>IP 地址</b><br />\n（<b>这步一定要小心，别填错了</b>）<br />\nIP 地址一共四段，头三段分别填写 <b>Host-Only</b> 子网的网络地址的头三个数字（请回顾刚才的章节——★真实系统的虚拟网卡）。<br />\nIP 地址的第四段，你可以填 <b>2到254</b> 之间的任何一个数。<br />\n再提醒一下：虚拟系统A和虚拟系统B各自有一块 Host-Only 网卡，这两块网卡的 IP 地址头三位是一样的，<span><b>第四位不能相同——否则 IP 地址会冲突</b></span>。<br />\n<b>子网掩码</b><br />\n填写 255.255.255.0<br />\n<b>默认网关</b><br />\n不用填<br />\n<b>DNS</b><br />\n不用填</p>\n<h3>◇代理软件的安装</h3>\n<p>\n　　在双虚拟机方案中，<b>代理是安装在 &#8220;虚拟系统B&#8221; 里面的</b>，别搞混喽！关于代理软件的安装，就不用再啰嗦了吧？</p>\n<h3>◇上网软件的配置（以浏览器为例）</h3>\n<p>\n　　在双虚拟机方案中，那些有危险的<b>上网软件是安装在 &#8220;虚拟系统A&#8221; 里面的</b>，别搞错喽！<br />\n　　下面详细说说上网软件的代理配置。<br />\n　　为网络软件配置代理的时候，通常要填写代理的 IP 地址和端口号。端口号通常不会搞错。因为每一款代理软件开启的端口号是固定的。但是 IP 地址常常会填错。所以<b>请大伙儿把下面看仔细喽！</b><br />\n　　填写代理的 IP 地址，<b>千万不能</b>填 127.0.0.1，因为这个地址表示本机，也就是 &#8220;虚拟系统A&#8221; 自己。<br />\n　　<b>正确的写法</b>是：填写另一个虚拟系统（虚拟系统B）的那个 <b>Host-Only</b> 网卡的 IP。<br />\n　　因为 &#8220;虚拟系统B&#8221; 有两块网卡，很多人填错了，栽倒在这一步。俺以IE浏览器为例，截图如下<br />\n<img src=\"http://lh3.googleusercontent.com/E4_zkEEFoQwmHuHdp9JOps50_4GNu2yfL9mxUm8uQUE3nsbzVd6p3xNSCdGlQrgLhP1VMjVeg8hsPLQ8x8wEt-oIyJDBpA5KVZM3-6tVPuFsn6dyCTENbWAq0Y8\" alt=\"不见图 请翻墙\" /></p>\n<h2>★结尾</h2>\n<p>\n　　由于涉及两套方案，而且涉及两种虚拟机软件，本文有点长，步骤有点多。如果你根据本教程配置完毕，还是不行，请到<a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2013/01/howto-cover-your-tracks-7.html\">本文留言</a>，俺会尽量解答。</p>\n<p><a rel=\"nofollow\" href=\"http://program-think.blogspot.com/2010/04/howto-cover-your-tracks-0.html#index\">回到本系列的目录</a><img src=\"http://feeds.feedburner.com/~r/programthink/~4/v1vJXNJZoKM\" height=\"1\" width=\"1\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"450\" height=\"309\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=2ea93c5b7b\">\n<a href=\"http://eepurl.com/msuvD\">墙外新闻实时更新 欢迎订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1004,"categories":[18270,18269,9203],"tags":[5908,8510,9400,8795]}