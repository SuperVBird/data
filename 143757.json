{"id":143757,"link":"https://chinadigitaltimes.net/chinese/2011/04/z-blog在apache的php下使用/","date":"2011-04-08T04:30:12Z","modified":"2011-04-08T04:30:12Z","title":"Z-Blog在Apache的PHP下使用","content":"<p><p>　　<a href=\"http://www.williamlong.info/cat/?tags=Zblog\">Z-Blog</a>程序是基于IIS+ASP环境开发的，理论上并不能在Apache+PHP+MySQL环境下运行，不过有时可能因为某种情况，需要将Z-Blog暂时迁移到Apache平台，本文将讲述一下迁移的具体形式。</p>\n<p>　　迁移的思路是，将Z-Blog全部静态化，动态化的部分，使用PHP代码回调ASP服务器上的地址，数据库依旧放在ASP的服务器上，使用双域名形式，通过FTP工具将ASP服务器上的HTML文件复制到PHP的服务器上。</p>\n<p>　　Z-Blog系统需要使用“静态首页生成插件”，这样首页和文章页都实现了静态HTML文件，分类页和标签页原本是动态的，修改起来比较麻烦，需要修改Z-Blog源代码。</p>\n<p>　　修改方法是，先建立一个cat目录，将根目录下的catalog.asp文件复制过来，修改为default.asp，将里面的include路径修改一下。</p>\n<p>　　接着，修改FUNCTION目录下的c_system_base.asp，c_system_event.asp，c_system_lib.asp文件，搜索替换掉“catalog.asp”为“cat/”，这样目录页和分类页就会调用cat目录而不是asp文件。</p>\n<p>　　之后，将所有的HTML都FTP到Apache主机上，对于cat目录，则建立一个index.php文件，文件内容如下：</p>\n<p><?php</p>\n<p>$qstring = isset($_SERVER[&#8220;QUERY_STRING&#8221;]) ? $_SERVER[&#8220;QUERY_STRING&#8221;] : &#8220;&#8221;;</p>\n<p>$url = &#8220;http://www.williamlong.info/cat/?&#8221;.$qstring;</p>\n<p>$file=file_get_contents($url);</p>\n<p>echo $file;</p>\n<p>?></p>\n<p>　　这样，目录页和分类页的调用都会自动抓取原先ASP服务器上的文件。</p>\n<p>　　最后，在Apache服务器上编辑.htaccess文件，内容如下：</p>\n<p>RewriteEngine On<br />RewriteBase /<br />RewriteRule ^upload/(.*)$ http://www.williamlong.info/upload/$1 [R=301,L]<br />RewriteRule ^download/(.*)$ http://www.williamlong.info/download/$1 [R=301,L]<br />RewriteRule ^function/(.*)$ http://www.williamlong.info/function/$1 [R=301,L,QSA]</p>\n<p>　　经过这样一番处理，在Apache环境下也可以浏览Z-Blog生成的博客了。</p>\n<p><img alt=\"Z-Blog在Apache的PHP下使用\" src=\"http://download.williamlong.info/upload/2608_1.jpg\" /></p>\n<p>　　不过目前还存在一些问题，主要包括，留言评论功能无法使用（单独使用另外一个插件可以勉强支持评论），侧栏动态加载的内容无法显示，文章量浏览无法计数，评分插件失效，更新较为麻烦。</p>\n<p>　　目前更新博客的方法是，修改hosts文件，将Z-Blog的域名再次指向原先ASP服务器，添加文章后，再FTP到Apache服务器上，原先我曾经考虑在两台服务器上同时<a href=\"http://www.williamlong.info/archives/2222.html\">安装Dropbox的方法</a>实现同步，但后来发现，一些国外的虚拟主机已经开始禁止在主机上运行Dropbox了，其系统会自动检测Dropbox进程，并发邮件警告用户，称运行这个程序违反其政策，要求停止这个进程，因此只能考虑使用自动FTP的方法实现同步。</p>\n<p><a href=\"http://www.williamlong.info/archives/2608.html\">评论《Z-Blog在Apache的PHP下使用》的内容&#8230;</a></p>\n<h3>相关文章:</h3>\n<ul>\n<p><a href=\"http://www.williamlong.info/archives/2114.html\">Z-Blog自定义时间评论关闭功能的修改</a></p>\n<p><a href=\"http://www.williamlong.info/archives/2062.html\">Z-Blog性能优化和评论IP显示</a></p>\n<p><a href=\"http://www.williamlong.info/archives/1885.html\">Z-Blog文件复制插件</a></p>\n<p><a href=\"http://www.williamlong.info/archives/1850.html\">Z-Blog垃圾留言判定新方法</a></p>\n<p><a href=\"http://www.williamlong.info/archives/1694.html\">Z-Blog Akismet插件更新升级</a></p>\n</ul>\n<p><img alt=\"统计\" border=\"0\" src=\"http://img.tongji.linezing.com/707050/tongji.gif\" /><br />关于我们： 地址 &#8211; www.williamlong.info &#8211; <a href=\"http://www.google.com/reader/shared/williamlone\">我的Google Reader</a> &#8211; <a href=\"http://twitter.com/williamlong\">我的Twitter</a> <br />月光博客投稿信箱：williamlong.info(at)gmail.com</p>\n<p><b>要翻墙？(发邮件到Gmail):fanqiangyakexi1ATgmail.com</b></p>\n","author":176,"categories":[9203],"tags":[]}