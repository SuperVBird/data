{"id":305654,"link":"https://chinadigitaltimes.net/chinese/2013/07/编程随想-online-backup-virtual-encrypted-disk/","date":"2013-07-26T06:16:11Z","modified":"2013-07-26T06:16:11Z","title":"编程随想 | online backup Virtual encrypted disk","content":"<p>文件备份技巧：组合&#8221;虚拟加密盘&#8221;和&#8221;网盘&#8221;</p>\n<p><span>如果你看到这行红字，说明你的博客阅读器无法显示修改后的博文内容 :(</span><br />\n可以考虑换一个阅读器</p>\n<h2>★先插播鸣谢和站务通告</h2>\n<p>\n　　前几天（23日）已经把原先存放在 SkyDrive 的电子书全部同步到 Dropbox。另外，<a rel=\"nofollow\" target=\"_blank\" href=\"https://code.google.com/p/program-think/wiki/Books\">电子书清单</a>已经补充了 Dropbox 的下载链接。想下载电子书的网友，今后可以从这两个网盘任选其一。<br />\n　　在此，<b>郑重感谢几十位帮俺扩容 Dropbox 空间的网友，你们的帮助会激励俺分享更多电子书</b>。<br />\n　　顺便提醒一下：<br />\n　　仅仅点击俺的邀请链接进行注册，并不会给俺增加 500 MB 空间；需要在注册成功之后，再安装 Dropbox 客户端才会真正扩容。<br />\n　　另外，根据 <a rel=\"nofollow\" target=\"_blank\" href=\"https://www.dropbox.com/pricing_terms\">Dropbox 的服务条款</a>，<b>免费帐号如果连续90天不使用，可能会被强制销户</b>。目前俺不清楚的是：如果某个帮俺扩容的网友被销户，俺网盘扩容的空间是否被收回？<br />\n　　如果还有其他网友想要开通 Dropbox，可以继续点击<a rel=\"nofollow\" target=\"_blank\" href=\"http://db.tt/fRYKnoQ2\">俺的邀请链接</a>，双方都可以增加 500 MB（确实想使用 Dropbox 的再点击）。</p>\n<hr></p>\n<h2>★名词解释</h2>\n<p>\n　　今天要讲的招数，其实在3月份的博文《<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2013/03/google-reader-dead.html\">Google Reader 之死——原因分析、应对措施、教训</a>》中已经稍微提到过了。当时俺承诺说：抽空单独写一篇介绍，所以就有了今天这篇博文。<br />\n　　在进入正题之前，先稍微做一下名词解释。&#8221;网盘&#8221;就不用解释了吧？大伙儿应该都明白。&#8221;加密盘&#8221;这个概念，技术菜鸟可能没听过，俺稍微解释一下。</p>\n<p>　　磁盘加密有两种常见的类型：物理加密盘 和 虚拟加密盘。下面分别介绍。</p>\n<h3>◇物理加密盘</h3>\n<p>\n　　磁盘加密工具直接对你的某个分区（或整个硬盘）进行加密。加密之后，该分区（或硬盘）上存储的数据全部变成密文。即使有人盗取你的硬盘，也无法读取其中存储的数据。</p>\n<h3>◇虚拟加密盘</h3>\n<p>\n　　加密工具先创建一个虚拟分区。这个虚拟分区其实对应于物理硬盘上的一个大文件（以下称&#8221;卷文件&#8221;）。你创建的虚拟分区有多大，这个&#8221;卷文件&#8221;就有多大。然后捏，加密工具可以挂载（Mount）该文件，挂载之后，你的系统会多出一个盘符。给你的感觉就好象多了一块硬盘（虚拟硬盘）。你存放到这个虚拟硬盘上的数据，都自动被加密。</p>\n<h3>◇优缺点对比</h3>\n<p>\n　　<b>&#8220;虚拟加密盘&#8221;的优点 和 &#8220;物理加密盘&#8221;的缺点</b><br />\n　　主要就是便于备份。因为&#8221;虚拟加密盘&#8221;说白了就是一个大文件，你只要把这个大文件 copy 到其它地方，就相当于完成了虚拟盘的备份。<br />\n　　而&#8221;物理加密盘&#8221;要备份，就相对麻烦一些。你需要使用专门的磁盘备份工具（比如 Ghost）</p>\n<p>　　<b>&#8220;物理加密盘&#8221;的优点 和 &#8220;虚拟加密盘&#8221;的缺点</b><br />\n　　对于操作系统的系统分区，只能采用&#8221;物理加密盘&#8221;的方式，而无法采用&#8221;虚拟加密盘&#8221;的方式。</p>\n<h2>★&#8221;加密盘&#8221;搭配&#8221;网盘&#8221;的好处</h2>\n<p>\n　　所谓的&#8221;加密盘搭配网盘&#8221;，其实说来很简单，就是找一个<b>带同步功能</b>的网盘。然后把你本地的加密盘文件同步到网盘上（再啰嗦一下：是同步加密盘的&#8221;卷文件&#8221;本身，而不是加密盘里面的文件）。这么干有如下几个好处</p>\n<h3>◇优点之一：&#8221;保密性&#8221;</h3>\n<p>\n　　这个好处是最明显的。因为你同步到网盘的是&#8221;加密盘文件&#8221;，别人很难偷窥你上传的数据。至少可以防止如下几种情况。</p>\n<p>　　<b>1. 防止网盘提供商偷窥</b><br />\n　　大伙儿千万不要相信网盘提供商，美国的网盘提供商会被 NSA（美国国安局）偷窥，中国的网盘提供商会被朝廷偷窥（金盾工程）。</p>\n<p>　　<b>2. 防止上传过程的网络监视</b><br />\n　　除了网盘提供商的风险，还有数据传输过程的风险。因为有些网盘在同步的时候，没有进行加密传输（比如某些国内网盘）。在这种情况下，一旦有人对你的网络传输流量进行监控（术语叫&#8221;嗅探&#8221;），就有可能拿到你同步的所有文件。</p>\n<p>　　<b>3. 防止网盘被入侵</b><br />\n　　即使网盘帐号被盗，入侵者拿到的也只是加密盘——看不到你原始的数据。<br />\n　　不要以为网盘的密码复杂了，就不会被盗。有些时候不是你的密码出问题，而是网盘提供商出问题。即使是大名鼎鼎的 Dropbox 也曾经出现过严重的安全问题（<a rel=\"nofollow\" target=\"_blank\" href=\"http://mi.itxinwen.com/2011/0621/298159.shtml\">2011年，Dropbox曝出安全漏洞：任意密码均可登录</a>）</p>\n<h3>◇优点之二：&#8221;可用性&#8221;</h3>\n<p>\n　　这个好处也很明显，因为你使用了网盘，提高了数据的&#8221;可用性&#8221;。即使你电脑的硬盘坏了、家中失火了、家中被盗了、遭遇地震了，都不用怕数据丢失。</p>\n<h3>◇优点之三：降低对&#8221;云端应用&#8221;的依赖</h3>\n<p>\n　　有些同学看到这个小标题，可能会感到奇怪并反问——&#8221;网盘&#8221;不也属于云端吗？别着急，请听俺细细道来。<br />\n　　就拿本月初刚刚关闭的 Google Reader 来说事儿。<br />\n　　俺的读者中有很多 GR 的重度用户，他们不光用 GR 来阅读博客，而且用 GR 来保存自己喜欢的文章——每当看到一篇好文章，就&#8221;加星&#8221;。也就是说，这些同学不光拿 GR 　　当阅读器，而且拿 GR 当资料库。一旦 GR 关闭，那可就麻烦啦！<br />\n　　再来说说俺的做法。<br />\n　　俺也是 GR 的重度用户，但是俺不依赖 GR 的&#8221;加星&#8221;功能。每次看到一篇好文章，俺会把文章的内容（包括内嵌图片）都复制到本地的资料库。这个资料库存放在&#8221;虚拟加密盘&#8221;，然后俺把&#8221;虚拟加密盘&#8221;同步到某个网盘上。<br />\n　　这么做的主要好处是：你个人的数据还是放在本地而不是云端，网盘只是用来备份。所以 GR 关闭不影响俺收藏的文章。另外，即使俺用的网盘倒闭了，也只需要另外注册一个免费的网盘，然后重新同步一下加密盘。整个过程很简单，点几下鼠标就搞定了。</p>\n<h2>★磁盘加密软件的选择</h2>\n<p>\n　　在《<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2013/06/privacy-protection-1.html\">如何保护隐私[1]：关于软件和服务的选择</a>》一文中，俺提到商业公司和非营利组织的差异，也提到开源软件和闭源软件的差异。那篇博文提到的原则也适用于磁盘加密工具的选型。比如10年俺用的是 PGPdisk，前几年就改用 TrueCrypt。因为 PGP 是商业公司（已经被 Symantec 收购），而 TrueCrypt 是开源组织维护的。<br />\n　　到目前为止，TrueCrypt 是最靠谱的磁盘加密工具。这玩意儿不光功能齐全，而且应用很广；当然最重要还是它的坚固性——据说美国 FBI 碰到嫌犯使用的 TrueCrypt 加密盘也束手无策。<br />\n　　关于 TrueCrypt，俺在2011年写过一篇介绍《<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2011/05/recommend-truecrypt.html\">TrueCrypt——文件加密的法宝</a>》。没用过的同学，不妨先看看。</p>\n<h2>★网盘的选择</h2>\n<p></p>\n<h3>◇容量</h3>\n<p>\n　　显然，免费空间越大越好。这个无需多解释。<br />\n　　维基百科上有一个<b>网盘对比清单</b>（在&#8221;<a rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Comparison_of_online_backup_services\">这里</a>&#8220;），里面列出不同网盘的免费空间大小。</p>\n<h3>◇网速</h3>\n<p>\n　　通常来说，提供网盘的公司，服务器速度都不会慢。但是天朝是一个奇葩的国家，GFW 把墙外的很多网盘都给封了。<br />\n　　如果你要用网盘来同步&#8221;加密盘&#8221;，考虑到加密盘都比较大（通常都是 GB 级别），你要么使用墙内的网盘，要么使用墙外<b>尚未被封</b>的网盘。</p>\n<h3>◇单文件大小上限</h3>\n<p>\n　　很多网盘都会限制单个文件的大小上限。详情请看上述<a rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Comparison_of_online_backup_services\">网盘对比清单</a>中的 &#8220;Maximum per-file size&#8221; 这一列。<br />\n　　使用本文的方案，你最好找一个文件大小无上限的网盘。<br />\n　　如果你使用的网盘有文件大小上限，并且该上限<b>小于</b>你的加密盘&#8221;卷文件&#8221;，那在同步之前还得先分割&#8221;卷文件&#8221;，太麻烦了（如何分割加密盘的卷文件，待会儿介绍）。</p>\n<h3>◇是否支持（字节级）差异同步</h3>\n<p>\n　　带同步功能的网盘，几乎都支持<b>文件级</b>的差异同步（只上传修改过的文件）。但很多都不支持&#8221;<b>字节级</b>&#8220;的差异同步。<br />\n　　采用这种同步方式，网盘客户端会分析某个文件被修改的部分，然后只上传修改过的那些字节。这里面用到一种技术叫&#8221;差分编码&#8221;（洋文叫&#8221;Delta Encoding&#8221;），有兴趣的同学可以看维基百科&#8221;<a rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Delta_encoding\">这里</a>&#8220;的介绍。</p>\n<p>　　对于本文介绍的招数，字节一级的差异同步很重要。刚才说了，&#8221;卷文件&#8221;通常比较大（GB 级别）。如果网盘客户端不支持&#8221;差分编码&#8221;，每次修改过加密盘里面的内容，就需要把<b>整个</b>&#8220;卷文件&#8221;上传，（时间和流量）太不划算啦。<br />\n　　在知名的网盘中，Dropbox 可能是最早实现&#8221;字节级差异同步&#8221;的。因为这玩意儿太技术化，很多网盘的介绍资料都没有提及。所以俺也不太清楚哪些网盘支持&#8221;字节级差异同步&#8221;，哪些网盘不支持。<br />\n　　如果你想知道自己使用的网盘是否支持，可以做个小测试。假如你手头已经有一个加密盘（至少是上百兆的），先把加密盘的&#8221;卷文件&#8221;同步到网盘。然后在加密盘中&#8221;修改某个小文件&#8221;或&#8221;增加某个小文件&#8221;。然后再把加密盘的卷文件同步一次。如果第二次同步很快完成，说明该网盘的客户端支持&#8221;字节级差异同步&#8221;。</p>\n<h2>★常见问题解答 (FAQs)</h2>\n<p></p>\n<h3>◇磁盘加密工具会锁住加密盘的&#8221;卷文件&#8221;，导致无法同步</h3>\n<p>\n　　几乎所有的磁盘加密工具，当挂载虚拟加密盘的时候，都会锁住加密盘对应的物理文件。&#8221;卷文件&#8221;一旦被锁住，就无法直接对其进行读写——包括网盘客户端也无法读写这个文件。<br />\n　　解决方法就是：<b>先&#8221;卸载&#8221;（Umount）加密盘，然后再同步</b>。换句话说：<b>挂载</b>加密盘的时候不要同步；加密盘<b>卸载</b>之后再同步。<br />\n　　比如你可以利用睡觉时间或吃饭时间，卸载加密盘，然后同步。</p>\n<h3>◇&#8221;卷文件&#8221;大小超过网盘&#8221;单文件上限&#8221;</h3>\n<p>\n　　碰到这种情况，俺首先强烈建议换一个网盘。<br />\n　　如果你实在不想换网盘，可以考虑把加密盘分割之后再同步。但是这么干会比较麻烦，而且分割之后再同步有一个缺点：你需要占用两倍的本地硬盘空间。</p>\n<p>　　分割文件的工具很好找，Google 上能搜到一大把。<br />\n　　对于 Windows 用户，名气比较大的是 <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.hjsplit.org/windows/\">hjsplit</a>（这玩意儿支持的平台很多，连 DOS 都支持）。<br />\n　　对于 Linux 用户可以直接用命令行的 split 分割文件，用 cat 命令合并分割后的文件。</p>\n<p>　　除了用专门的文件分割工具，还可以考虑用压缩工具进行分割（7Zip 和 WinRAR 都支持分文件压缩，类似于&#8221;文件分割&#8221;的功能）。<br />\n　　但是切记一点：<b>加密内容是难以压缩的</b>（看过&#8221;密码学&#8221;和&#8221;信息论&#8221;的同学应该知道，加密之后的&#8221;熵&#8221;极大，再牛的压缩软件也压不下来）。所以，使用压缩工具对加密盘进行&#8221;分文件压缩&#8221;，一定要关闭压缩选项（对于 7zip，在&#8221;压缩等级&#8221;那个选项中选择&#8221;仅存储&#8221;）。</p>\n<h3>◇&#8221;卷文件&#8221;大小超过网盘总容量</h3>\n<p>\n　　碰到这种情况，你有两个选择：<br />\n1. 换一个空间大的网盘<br />\n2. 申请多个网盘帐号，然后使用前面提到的&#8221;分割文件&#8221;的方案——把加密盘的&#8221;卷文件&#8221;分割成 N 块，分别同步到不同的网盘。</p>\n<p>　　对于使用 Dropbox 的同学，很可能会碰到这种情况。Dropbox 有很多优点，而最明显的缺点就是空间小。</p>\n<p><b>俺博客上，和本文相关的帖子（需翻墙）</b>：<br />\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2011/05/file-encryption-overview.html\">文件加密的扫盲介绍</a><br />\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2011/05/recommend-truecrypt.html\">TrueCrypt——文件加密的法宝</a><br />\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://program-think.blogspot.com/2013/06/privacy-protection-0.html\">如何保护隐私(系列)</a><img src=\"http://feeds.feedburner.com/~r/programthink/~4/aixd6G2VgCU\" height=\"1\" width=\"1\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"450\" height=\"309\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=2ea93c5b7b\">\n<a href=\"http://eepurl.com/msuvD\">墙外新闻实时更新 欢迎订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1004,"categories":[18270,18269,9203],"tags":[9400]}