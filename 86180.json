{"id":86180,"link":"https://chinadigitaltimes.net/chinese/2010/07/使用-gae-将-google-latitude-地理位置同步到人人网/","date":"2010-07-22T23:51:17Z","modified":"2010-07-22T23:51:17Z","title":"使用 GAE 将 Google Latitude 地理位置同步到人人网","content":"<p><p>来自: <a href=\"http://www.feedzshare.com/b/803891/2\">谷奥——探寻谷歌的奥秘 &#8211; FeedzShare</a>  <br />\n<br />发布时间:2010年07月21日,  已有 5 人推荐 </p>\n<hr>\n<div>\n<p><img title=\"google-latitude-renren-status\" height=\"63\" alt=\"google-latitude-renren-status\" src=\"http://www.google.org.cn/wp-content/uploads/2010/07/googlelatituderenrenstatus.jpg\" width=\"453\" border=\"0\" /> </p>\n<p>感谢 @LucienLu 的投递和自爆。</p>\n<p>非常奇怪人人网明知地理信息的重要价值，仍然没有从浏览器获取用户 geo 信息。geo 很有趣，于是自己先实现了用 GAE 将 Google Latitude 同步到 renren。 </p>\n<p>        感谢这位同学<a href=\"http://d.ream.at/sync-twitter-timeline-to-renren-status-via-google-app-engine/\">用 GAE 同步 twitter 到人人网状态</a>的方法，很有用，让我没发几条垃圾状态。 </p>\n<p>需求： </p>\n<ol>\n<li>手机安装 Google 地图并且开通谷歌纵横</li>\n<li>申请一个 GAE 账户并安装 <a href=\"http://www.google.org.cn/tag/python\">python</a> 和 GAE 开发包，可以看 <a href=\"http://code.google.com/intl/zh-CN/appengine/\">Google 官方的文档</a>。然后创建一个 GAE 应用，我的是 latitude2renren</li>\n<li><a href=\"http://code.google.com/apis/accounts/docs/RegistrationForWebAppsAuto.html\">注册你的 GAE 应用</a>，点击 <a href=\"https://www.google.com/accounts/ManageDomains\">Manage Your Domains</a> 链接，注册的目的是获得 consumer key 和 consumer secret。</li>\n</ol>\n<p>      在GAE开发包安装目录下新建一个文件夹，比如我的</p>\n<blockquote>\n<p>X:Program FilesGooglegoogle_appenginelatitude2renren </p>\n</blockquote>\n<p>        创建以下文件： </p>\n<p> <span></span></p>\n<p>app.yaml </p>\n<blockquote>\n<p>application: 你的app应用名字     <br />version: 1      <br />runtime: python      <br />api_version: 1</p>\n<p>handlers:      <br />&#8211; url: /OAuth/.*      <br />  script: OAuth/OAuthHandle.py      <br />  secure: optional      <br />  login: admin      </p>\n</blockquote>\n<p>cron.yaml</p>\n<blockquote>\n<p>cron:     <br />&#8211; description: sync      <br />  url: /OAuth/FetchContent      <br />  schedule: every 5 minutes</p>\n</blockquote>\n<p>oauth.py Python 的 OAuth 库。这个文件直接从 <a href=\"http://oauth.googlecode.com/svn/code/python/oauth/\">OAuth 的官方代码</a>弄的。 </p>\n<p>建立文件夹 OAuth，加入文件 OAuthHandle.py (<a href=\"http://www.lostriver.net/wp-content/uploads/2010/07/OAuthHandle.py\">下载</a>)。</p>\n<p>        打开这个文件，对前面的 setting area 进行修改，修改 OAuthConsumerKey，OAuthConsumerSecret，renren_usr，renren_passwd。然后搜索 latitude2renren，替换成你的appid。其他不需要改。 </p>\n<p>        还有一些其他特性可以在这里实现： </p>\n<ol>\n<li>默认每5分钟检查一次位置，可以修改 cron.yaml</li>\n<li>精度可以调节为最佳或者城市，OAuthHandle.py 修改 line 42 和 line 334，把 best 改成 city，但修改成 city 后同步的地标信息有误，建议自行修改 line 199 的正则规则</li>\n<li>默认在人人网两次发状态的间隔大于8000000 millisecond，也就是两个多小时，修改 line368     <br />经纬度变化之和大于0.05度（回忆一下中学知识，纬度每变化1度大约是110公里）是更新的必要条件，修改line 367</li>\n</ol>\n<p>        然后在X:Program FilesGooglegoogle_appengine目录下运行 </p>\n<blockquote>\n<p>appcfy.py update ./你的文件夹</p>\n</blockquote>\n<p>        上传GAE。 </p>\n<p>        最后一步是通过 <a href=\"http://oauth.net/\">OAuth</a> 授权你的应用获得你的 Latitude 信息，访问 https://你的appid.appspot.com/OAuth/GetRequestToken，按提示操作即可。 </p>\n<p>        同步的效果是在条件满足时（默认为上次同步发生在8000秒前，经纬度变化之和超过0.05），五分钟之内更新一条人人网状态：I’m at 中国xxxxxx. <a href=\"http://maps.google.com/maps?ll=%E7%BB%8F%E5%BA%A6,%E7%BA%AC%E5%BA%A6&#038;z=12&#038;t=m\">http://maps.google.com/maps?ll=经度,纬度&#038;z=12&#038;t=m</a> (Auto Sync from Google) </p>\n<p>        我这里代码很省，比如 JSON 解析用的是正则；由于 <a href=\"http://code.google.com/apis/maps/documentation/webservices/index.html\">Google Maps API Web Services</a> 即将于本月推出，坐标转中文地标用的是 http://maps.google.com/maps?output=js&#038;hl=zh-CN&#038;oe=UTF-8&#038;q=纬度+经度 <strike>这样的Google非正式API</strike>(更新，已经使用官方 <a href=\"http://code.google.com/apis/maps/documentation/geocoding/\">The Google Geocoding API</a>，有效解决部分地区无法找到地标的问题。原API的第三方文档见 <a href=\"http://mapki.com/wiki/Google_Map_Parameters\">mapki.com</a>)。</p>\n<p>原文地址:</p>\n<p><a title=\"http://www.lostriver.net/google-latitude-to-renren/\" href=\"http://www.lostriver.net/google-latitude-to-renren/\">http://www.lostriver.net/google-latitude-to-renren/</a></p>\n<hr>\n<p><small>© gkp 发表于 <a href=\"http://www.google.org.cn\">谷奥——探寻谷歌的奥秘 ( http://www.google.org.cn )</a>, 2010.  |<br />\n<a href=\"http://www.google.org.cn/posts/sync-google-latitude-geo-information-to-renren.html#comments\">没有评论</a> |<br />\n<a href=\"http://www.google.org.cn/posts/sync-google-latitude-geo-information-to-renren.html\">永久链接</a> |<br />\n<a href=\"http://google.org.cn/about/\">关于谷奥</a> |<br />\n<a href=\"http://google.org.cn/submit/\">投稿/爆料</a><br />\nPost tags: <a href=\"http://www.google.org.cn/tag/google-app-engine\" rel=\"tag\">Google App Engine</a>, <a href=\"http://www.google.org.cn/tag/google-latitude\" rel=\"tag\">Google Latitude</a>, <a href=\"http://www.google.org.cn/tag/google-maps\" rel=\"tag\">Google Maps</a>, <a href=\"http://www.google.org.cn/tag/oauth\" rel=\"tag\">OAuth</a>, <a href=\"http://www.google.org.cn/tag/python\" rel=\"tag\">Python</a>, <a href=\"http://www.google.org.cn/tag/renren\" rel=\"tag\">RenRen</a><br />\n<a href=\"http://android.google.org.cn/\"><b>欢迎订阅谷安子站，关注Android新闻，技巧及更多</b></a><br />\n</small></p>\n<p><img src=\"http://img.tongji.linezing.com/1105192/tongji.php\" border=\"0\" width=\"0\" height=\"0\" /></p>\n</div>\n<p><img src=\"http://img.tongji.linezing.com/1017243/tongji.gif\" /><img src=\"http://img.tongji.linezing.com/997968/tongji.gif\" /></p>\n<p>请看原文：<br />\n<a target=\"_blank\" href=\"http://www.google.org.cn/posts/sync-google-latitude-geo-information-to-renren.html\" title=\"使用 GAE 将 Google Latitude 地理位置同步到人人网\">使用 GAE 将 Google Latitude 地理位置同步到人人网</a></p>\n","author":176,"categories":[1],"tags":[5908,8339,8897]}