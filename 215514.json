{"id":215514,"link":"https://chinadigitaltimes.net/chinese/2012/03/阮一峰-基于用户投票的排名算法（三）：stack-overflow/","date":"2012-03-15T14:02:03Z","modified":"2012-03-15T14:02:03Z","title":"阮一峰 | 基于用户投票的排名算法（三）：Stack Overflow","content":"<p><p>上一篇文章，我介绍了<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_reddit.html\">Reddit</a>的排名算法。</p>\n<p>它的特点是，用户可以投赞成票，也可以投反对票。也就是说，除了时间因素以外，只要考虑两个变量就够了。</p>\n<p>但是，还有一些特定用途的网站，必须考虑更多的因素。世界排名第一的程序员问答社区<a rel=\"nofollow\" href=\"http://stackoverflow.com/?tab=hot\">Stack Overflow</a>，就是这样一个网站。</p>\n<p><a rel=\"nofollow\" href=\"http://stackoverflow.com/?tab=hot\"><img src=\"http://image.beekka.com/blog/201203/bg2012031101.jpg\" /></a></p>\n<p>你在上面提出各种关于编程的问题，等待别人回答。访问者可以对你的问题进行投票（赞成票或反对票），表示这个问题是不是有价值。</p>\n<p><img src=\"http://image.beekka.com/blog/201203/bg2012031102.png\" /></p>\n<p>一旦有人回答了你的问题，其他人也可以对这个回答投票（赞成票或反对票）。根据投票结果，系统自动找出最佳回答。</p>\n<p><img src=\"http://image.beekka.com/blog/201203/bg2012031103.png\" /></p>\n<p>排名算法的作用是，找出某段时间内的热点问题，即哪些问题最被关注、得到了最多的讨论。</p>\n<p>在Stack Overflow的页面上，每个问题前面有三个数字，分别表示问题的得分、回答的数目和该问题的浏览次数。以这些变量为基础，就可以设计算法了。</p>\n<p><img src=\"http://image.beekka.com/blog/201203/bg2012031104.png\" /></p>\n<p>创始人之一的Jeff Atwood，曾经在几年前，<a rel=\"nofollow\" href=\"http://meta.stackoverflow.com/questions/11602/what-formula-should-be-used-to-determine-hot-questions\">公布</a>过排名得分的计算公式。</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=%5Cfrac%7B(log_%7B10%7DQviews)%5Ctimes%204%2B%5Cfrac%7BQanswers%5Ctimes%20Qscore%7D%7B5%7D%2Bsum(Ascores)%7D%7B((Qage%2B1)-(%5Cfrac%7BQage-Qupdated%7D%7B2%7D))%5E%7B1.5%7D%7D&#038;chs=120\" /></p>\n<p>写成<a rel=\"nofollow\" href=\"http://pastebin.com/FWJRbf1N\">php代码</a>，就是下面这样：</p>\n<p><a rel=\"nofollow\" href=\"http://pastebin.com/FWJRbf1N\"><img src=\"http://image.beekka.com/blog/201203/bg2012031105.png\" /></a></p>\n<p>各个算法变量的含义如下：</p>\n<p><strong>（1）Qviews（问题的浏览次数）</strong></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=(log_%7B10%7DQviews)%5Ctimes%204&#038;chs=40\" /></p>\n<p>某个问题的浏览次数越多，就代表越受关注，得分也就越高。这里使用了以10为底的对数，用意是当访问量越来越大，它对得分的影响将不断变小。</p>\n<p><strong>（2）Qscore（问题得分）和Qanswers（回答的数量）</strong></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=Qscore%20%5Ctimes%20%5Cfrac%7BQanswers%7D%7B5%7D&#038;chs=60\" /></p>\n<p>首先，Qscore（问题得分）= 赞成票-反对票。如果某个问题越受到好评，排名自然应该越靠前。</p>\n<p>Qanswers表示回答的数量，代表有多少人参与这个问题。这个值越大，得分将成倍放大。这里需要注意的是，如果无人回答，Qanswers就等于0，这时Qscore再高也没用，意味着再好的问题，也必须有人回答，否则进不了热点问题排行榜。</p>\n<p><strong>（3）Ascores（回答得分）</strong></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=sum(Ascores)&#038;chs=40\" /></p>\n<p>一般来说，&#8221;回答&#8221;比&#8221;问题&#8221;更有意义。这一项的得分越高，就代表回答的质量越高。</p>\n<p>但是我感觉，简单加总的设计还不够全面。这里有两个问题。首先，一个正确的回答胜过一百个无用的回答，但是，简单加总会导致，1个得分为100的回答与100个得分为1的回答，总得分相同。其次，由于得分会出现负值，因此那些特别差的回答，会拉低正确回答的得分。</p>\n<p><strong>（4）Qage（距离问题发表的时间）和Qupdated（距离最后一个回答的时间）</strong></p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=((Qage%2B1)-(%5Cfrac%7BQage-Qupdated%7D%7B2%7D))%5E%7B1.5%7D&#038;chs=60\" /></p>\n<p>改写一下，可以看得更清楚：</p>\n<p>　　<img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=(%5Cfrac%7BQage%7D%7B2%7D%2B%5Cfrac%7BQupdated%7D%7B2%7D%2B1)%5E%7B1.5%7D&#038;chs=60\" /></p>\n<p>Qage和Qupdated的单位都是秒。如果一个问题的存在时间越久，或者距离上一次回答的时间越久，Qage和Qupdated的值就相应增大。</p>\n<p>也就是说，随着时间流逝，这两个值都会越变越大，导致分母增大，因此总得分会越来越小。</p>\n<p><strong>（５）总结</strong></p>\n<p>Stack Overflow热点问题的排名，与<strong>参与度</strong>（Qviews和Qanswers）和<strong>质量</strong>（Qscore和Ascores）成正比，与<strong>时间</strong>（Qage和Qupdated）成反比。</p>\n<p>（完）</p>\n<div>\n<h3>文档信息</h3>\n<ul>\n<li>版权声明：自由转载-非商用-非衍生-保持署名 | <a rel=\"nofollow\" href=\"http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh\">Creative Commons BY-NC-ND 3.0</a></li>\n<li>原文网址：<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_stack_overflow.html\">http://www.ruanyifeng.com/blog/2012/03/ranking_algorithm_stack_overflow.html</a></li>\n<li>最后修改时间：2012年3月11日 15:56</li>\n<li>付费支持：<a rel=\"nofollow\" href=\"https://mai.alipay.com/p.htm?id=2012010602227616\"><img alt=\"支付宝担保交易\" src=\"http://chinadigitaltimes.net/chinese/files/2012/03/3a976ef2rmb_32.png.png\" /></a> | <a rel=\"nofollow\" href=\"https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&#038;business=yifeng.ruan@gmail.com&#038;currency_code=USD&#038;amount=2.99&#038;return=http://www.ruanyifeng.com/thank.html&#038;item_name=Ruan%20YiFeng's%20Blog&#038;undefined_quantity=1&#038;no_note=0\"><img alt=\"paypal\" src=\"http://chinadigitaltimes.net/chinese/files/2012/03/5ca83e43dollar_32.png.png\" /></a> </li>\n</ul>\n</div>\n<div>\n</div>\n<p><img src=\"http://chinadigitaltimes.net/chinese/files/2012/03/1967408ag2012031101.jpg-150x122.jpg\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"450\" height=\"309\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=750556\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"750556\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":1004,"categories":[9203],"tags":[5908,9400,8795]}