{"id":331589,"link":"https://chinadigitaltimes.net/chinese/2014/01/翻墙-shadowsocks服务端优化设置/","date":"2014-01-28T17:16:18Z","modified":"2014-01-28T17:16:18Z","title":"翻墙 | shadowsocks服务端优化设置","content":"<table cellpadding=\"0\" cellspacing=\"0\">\n<tbody>\n<tr>\n<td>\n<div align=\"center\">\n<table cellpadding=\"0\" cellspacing=\"0\">\n<tbody>\n<tr>\n<td>\n<div dir=\"ltr\"><a rel=\"nofollow\" target=\"_blank\" href=\"http://xijie.wordpress.com/2014/01/28/shadowsocks%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BC%98%E5%8C%96%E8%AE%BE%E7%BD%AE/\">shadowsocks服务端优化设置</a>              </div>\n<div>Via <a rel=\"nofollow\" target=\"_blank\" href=\"http://xijie.wordpress.com/\">细节的力量</a>              </div>\n<div dir=\"ltr\">\n<div align=\"left\">推特上两位推友@m0d8ye（libev版的作者）和@_zzzh提供的shadowsocks服务端网络优化方案，基本原理相似，都是通过修改<code>sysctl.conf</code>相关参数实施的，目标是在高并发、高延迟的网络环境下提高shadowsocks的响应和链接速度。</div>\n<div align=\"left\">@m0d8ye提供的<code>sysctl.conf</code>修改参数：<span></span></div>\n<blockquote>\n<div>net.core.wmem_max = 12582912         <br />net.core.rmem_max = 12582912          <br />net.ipv4.tcp_rmem = 10240 87380 12582912          <br />net.ipv4.tcp_wmem = 10240 87380 12582912          <br />net.ipv4.ip_local_port_range = 18000 65535          <br />net.ipv4.netfilter.ip_conntrack_tcp_timeout_time_wait = 1          <br />net.ipv4.tcp_window_scaling = 1          <br />net.ipv4.tcp_max_syn_backlog = 3240000          <br />net.core.somaxconn    = 3240000          <br />net.ipv4.tcp_max_tw_buckets = 1440000          <br />net.ipv4.tcp_congestion_control = cubic          <br />net.ipv4.tcp_tw_reuse = 1          <br />net.ipv4.tcp_fin_timeout = 15          <br />net.ipv4.tcp_syn_retries = 2          <br />net.ipv4.tcp_synack_retries = 2          <br />net.ipv4.tcp_tw_recycle = 1</div>\n</blockquote>\n<div align=\"left\">@_zzzh（原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://hong.im/2013/04/20/linux-tcp-tuning/\">高流量大并发linux Tcp 性能调优</a>）提供的<code>sysctl.conf</code>修改参数：</div>\n<blockquote>\n<div>net.ipv4.tcp_syncookies = 1         <br />net.ipv4.tcp_tw_reuse = 1          <br />net.ipv4.tcp_tw_recycle = 1          <br />net.ipv4.tcp_fin_timeout = 30          <br />net.ipv4.tcp_keepalive_time = 1200          <br />net.ipv4.ip_local_port_range = 10000 65000          <br />net.ipv4.tcp_max_syn_backlog = 8192          <br />net.ipv4.tcp_max_tw_buckets = 5000          <br />net.core.rmem_max = 67108864          <br />net.core.wmem_max = 67108864          <br />net.ipv4.tcp_rmem = 4096 87380 67108864          <br />net.ipv4.tcp_wmem = 4096 65536 67108864          <br />net.core.netdev_max_backlog = 250000          <br />net.ipv4.tcp_mtu_probing=1          <br />net.ipv4.tcp_congestion_control=hybla</div>\n</blockquote>\n<pre>sysctl net.ipv4.tcp_available_congestion_control  /sbin/modprobe tcp_hybla  nano /etc/sysctl.conf  sysctl -p</pre>\n<div align=\"left\">由于本人的shadowsocks为自用，高并发的多人使用效果没做具体测试，效果未知。但按方案二将拥塞算法由cubic改为hybla模式后，在晚高峰时段观看视频的速度确实有显著改善，推荐大家尝试。</div>\n<div align=\"left\">原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.free4u.com.ar/2314.html\" title=\"http://www.free4u.com.ar/2314.html\">http://www.free4u.com.ar/2314.html</a></div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<div>翻墙技术博客<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.chinagfw.org/2013/09/blog-post.html\">订阅地址及社交帐号</a></div>\n</p>\n<p><a href=\"https://s3.amazonaws.com/cdtimes/index.html?u=chinese\">中国数字时代亚马逊镜像</a>（墙内可直接点击）</p>\n","author":1005,"categories":[18270,18269,15300],"tags":[8795]}