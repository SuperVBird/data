{"id":176093,"link":"https://chinadigitaltimes.net/chinese/2011/08/阮一峰-贝叶斯推断及其互联网应用（一）/","date":"2011-09-01T00:03:57Z","modified":"2011-09-01T00:03:57Z","title":"阮一峰 | 贝叶斯推断及其互联网应用（一）","content":"<p><p><a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2010/08/not_working_hard_for_a_big_company.html\">一年前</a>的这个时候，我正在翻译Paul Graham的<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/docs/pg/\">《黑客与画家》</a>。</p>\n<p>那本书大部分谈的是技术哲学，但是第八章却写了一个非常具体的技术问题&#8212;-如何使用贝叶斯推断过滤垃圾邮件（<a rel=\"nofollow\" href=\"http://www.paulgraham.com/spam.html\">英文版</a>）？</p>\n<p>说实话，我没完全看懂那一章。那时，交稿截止日期已经过了，没时间留给我去啃概率论教科书了。我只好硬着头皮，按照字面意思把它译了出来。虽然交稿了，译文质量也还可以，但是心里很不舒服，下决心一定要搞懂它。</p>\n<p>一年过去了，我读了一些概率论文献，逐渐发现贝叶斯推断并没有想象的那么难。相反的，它的原理部分实际上很容易理解，甚至不需要用到高等数学。</p>\n<p>下面就是我的学习笔记。需要声明的是，我并不是这方面的专家，数学其实是我的弱项。所以，欢迎大家提出宝贵意见，让我们共同学习和提高。</p>\n<p>=====================================</p>\n<p><strong>贝叶斯推断及其互联网应用</strong></p>\n<p>作者：阮一峰</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082507.jpg\" /></p>\n<p><strong>一、什么是贝叶斯推断</strong></p>\n<p>贝叶斯推断（<a rel=\"nofollow\" href=\"http://en.wikipedia.org/wiki/Bayesian_inference\">Bayesian inference</a>）是一种统计学方法，用来估计统计量的某种性质。</p>\n<p>它是贝叶斯定理（<a rel=\"nofollow\" href=\"http://en.wikipedia.org/wiki/Bayes%27_theorem\">Bayes&#8217; theorem</a>）的应用。英国数学家托马斯·贝叶斯（Thomas Bayes）在1763年发表的一篇论文中，首先提出了这个定理。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082501.jpg\" /></p>\n<p>贝叶斯推断与其他统计学推断方法截然不同。它建立在主观判断的基础上，也就是说，你可以不需要客观证据，先估计一个值，然后根据推断结果不断修正。正是因为它的主观性太强，曾经遭到许多统计学家的诟病。</p>\n<p>贝叶斯推断需要大量的计算，因此历史上很长一段时间，无法得到广泛应用。只有等到计算机诞生以后，它才获得真正的重视。人们发现，许多统计量是无法事先进行客观判断的，而互联网时代出现的大型数据集，再加上高速运算能力，为验证这些统计量提供了方便，也为应用贝叶斯推断创造了条件，它的威力正在日益显现。</p>\n<p><strong>二、贝叶斯定理</strong></p>\n<p>要理解贝叶斯推断，就必须先理解贝叶斯定理。后者实际上就是计算&#8221;条件概率&#8221;的公式。</p>\n<p>所谓&#8221;条件概率&#8221;（Conditional probability），就是指在事件B发生的情况下，事件A发生的概率，用P(A|B)来表示。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082502.jpg\" /></p>\n<p>根据文氏图，可以很清楚地看到在事件B发生的情况下，事件A发生的概率就是P(A∩B)除以P(B)。</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3D%5Cfrac%7BP(A%5Ccap%20B)%7D%7BP(B)%7D&#038;chs=70\" /></p>\n<p>因此，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%5Ccap%20B)%3DP(A%7CB)%7BP(B)%7D&#038;chs=40\" /></p>\n<p>同理可得，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%5Ccap%20B)%3DP(B%7CA)%7BP(A)%7D&#038;chs=40\" /></p>\n<p>所以，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%7BP(B)%7D%3DP(B%7CA)%7BP(A)%7D&#038;chs=40\" /></p>\n<p>即</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3D%5Cfrac%7BP(B%7CA)%7BP(A)%7D%7D%7B%7BP(B)%7D%7D&#038;chs=70\" /></p>\n<p>这就是条件概率的计算公式。</p>\n<p><strong>三、全概率公式</strong></p>\n<p>由于后面要用到，所以除了条件概率以外，这里还要推导全概率公式。</p>\n<p>假定样本空间S，是两个事件A与A&#8217;的和。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082503.jpg\" /></p>\n<p>上图中，红色部分是事件A，绿色部分是事件A&#8217;，它们共同构成了样本空间S。</p>\n<p>在这种情况下，事件B可以划分成两个部分。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082504.jpg\" /></p>\n<p>即</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(B)%3DP(B%5Ccap%20A)%2BP(B%5Ccap%20A')&#038;chs=40\" /></p>\n<p>在上一节的推导当中，我们已知</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(B%5Ccap%20A)%3DP(B%7CA)P(A)&#038;chs=40\" /></p>\n<p>所以，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(B)%3DP(B%7CA)P(A)%2BP(B%7CA')P(A')&#038;chs=40\" /></p>\n<p>这就是全概率公式。它的含义是，如果A和A&#8217;构成样本空间的一个划分，那么事件B的概率，就等于A和A&#8217;的概率分别乘以B的条件概率之和。</p>\n<p>将这个公式代入上一节的条件概率公式，就得到了条件概率的另一种写法：</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3D%5Cfrac%7BP(B%7CA)P(A)%7D%7BP(B%7CA)P(A)%2BP(B%7CA')P(A')%7D&#038;chs=70\" /></p>\n<p><strong>四、贝叶斯推断的含义</strong></p>\n<p>对条件概率公式进行变形，可以得到如下形式：</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3DP(A)%5Cfrac%7BP(B%7CA)%7D%7BP(B)%7D&#038;chs=70\" /></p>\n<p>我们把P(A)称为&#8221;先验概率&#8221;（Prior probability），即在B事件发生之前，我们对A事件概率的一个判断。P(A|B)称为&#8221;后验概率&#8221;（Posterior probability），即在B事件发生之后，我们对A事件概率的重新评估。P(B|A)/P(B)称为&#8221;可能性函数&#8221;（Likelyhood），这是一个调整因子，使得预估概率更接近真实概率。</p>\n<p>所以，条件概率可以理解成下面的式子：</p>\n<p><img alt=\"mboxPosterior probability propto mboxPrior probability times mboxLikelihood\" src=\"http://upload.wikimedia.org/math/6/6/1/661d5a0dc2f5e23d8d1a40712284e6fb.png\" /></p>\n<p>这就是贝叶斯推断的含义。我们先预估一个&#8221;先验概率&#8221;，然后加入实验结果，看这个实验到底是增强还是削弱了&#8221;先验概率&#8221;，由此得到更接近事实的&#8221;后验概率&#8221;。</p>\n<p>在这里，如果&#8221;可能性函数&#8221;P(B|A)/P(B)>1，意味着&#8221;先验概率&#8221;被增强，事件A的发生的可能性变大；如果&#8221;可能性函数&#8221;=1，意味着B事件无助于判断事件A的可能性；如果&#8221;可能性函数&#8221;<1，意味着\"先验概率\"被削弱，事件A的可能性变小。</p>\n<p><strong>五、【例子】水果糖问题</strong></p>\n<p>为了加深对贝叶斯推断的理解，我们看两个例子。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082505.jpg\" /></p>\n<p>第一个例子。两个一模一样的碗，一号碗有30颗水果糖和10颗巧克力糖，二号碗有水果糖和巧克力糖各20颗。现在随机选择一个碗，从中摸出一颗糖，发现是水果糖。请问这颗水果糖来自一号碗的概率有多大？</p>\n<p>我们假定，H1表示一号碗，H2表示二号碗。由于这两个碗是一样的，所以P(H1)=P(H2)，也就是说，在取出水果糖之前，这两个碗被选中的概率相同。因此，P(H1)=0.5，我们把这个概率就叫做&#8221;先验概率&#8221;，即没有做实验之前，来自一号碗的概率是0.5。</p>\n<p>再假定，E表示水果糖，所以问题就变成了在已知E的情况下，来自一号碗的概率有多大，即求P(H1|E)。我们把这个概率叫做&#8221;后验概率&#8221;，即在E事件发生之后，对P(H1)的修正。</p>\n<p>根据条件概率公式，得到</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(H_%7B1%7D%7CE)%3DP(H_%7B1%7D)%5Cfrac%7BP(E%7CH_%7B1%7D)%7D%7BP(E)%7D&#038;chs=70\" /></p>\n<p>已知，P(H1)等于0.5，P(E|H1)为一号碗中取出水果糖的概率，等于0.75，那么求出P(E)就可以得到答案。根据全概率公式，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(E)%3DP(E%7CH_%7B1%7D)P(H_%7B1%7D)%2BP(E%7CH_%7B2%7D)P(H_%7B2%7D)&#038;chs=40\" /></p>\n<p>所以，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(E)%3D0.75%5Ctimes%200.5%2B0.5%5Ctimes%200.5%3D0.625&#038;chs=40\" /></p>\n<p>将数字代入原方程，得到</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(H1%7CE)%3D0.5%5Ctimes%20%5Cfrac%7B0.75%7D%7B0.625%7D%3D0.6&#038;chs=70\" /></p>\n<p>这表明，来自一号碗的概率是0.6。也就是说，取出水果糖之后，H1事件的可能性得到了增强。</p>\n<p><strong>六、【例子】假阳性问题</strong></p>\n<p>第二个例子是一个医学的常见问题，与现实生活关系紧密。</p>\n<p><img src=\"http://image.beekka.com/blog/201108/bg2011082506.jpg\" /></p>\n<p>已知某种疾病的发病率是0.001，即1000人中会有1个人得病。现有一种试剂可以检验患者是否得病，它的准确率是0.99，即在患者确实得病的情况下，它有99%的可能呈现阳性。它的误报率是5%，即在患者没有得病的情况下，它有5%的可能呈现阳性。现有一个病人的检验结果为阳性，请问他确实得病的可能性有多大？</p>\n<p>假定A事件表示得病，那么P(A)为0.001。这就是&#8221;先验概率&#8221;，即没有做试验之前，我们预计的发病率。再假定B事件表示阳性，那么要计算的就是P(A|B)。这就是&#8221;后验概率&#8221;，即做了试验以后，对发病率的估计。</p>\n<p>根据条件概率公式，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3DP(A)%20%5Cfrac%7BP(B%7CA)%7D%7BP(B)%7D&#038;chs=70\" /></p>\n<p>用全概率公式改写分母，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3DP(A)%20%5Cfrac%7BP(B%7CA)%7D%7BP(B%7CA)P(A)%2BP(B%7C%5Cbar%7BA%7D)P(%5Cbar%7BA%7D)%7D&#038;chs=70\" /></p>\n<p>将数字代入，</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=P(A%7CB)%3D0.001%5Ctimes%20%20%5Cfrac%7B0.99%7D%7B0.99%5Ctimes%200.001%2B0.05%5Ctimes%200.999%7D%5Capprox%200.019&#038;chs=70\" /></p>\n<p>我们得到了一个惊人的结果，P(A|B)约等于0.019。也就是说，即使检验呈现阳性，病人得病的概率，也只是从0.1%增加到了2%左右。这就是所谓的&#8221;假阳性&#8221;，即阳性结果完全不足以说明病人得病。</p>\n<p>为什么会这样？为什么这种检验的准确率高达99%，但是可信度却不到2%？答案是与它的误报率太高有关。（【习题】如果误报率从5%降为1%，请问病人得病的概率会变成多少？）</p>\n<p>有兴趣的朋友，还可以算一下&#8221;假阴性&#8221;问题，即检验结果为阴性，但是病人确实得病的概率有多大。然后问自己，&#8221;假阳性&#8221;和&#8221;假阴性&#8221;，哪一个才是医学检验的主要风险？</p>\n<p>===================================</p>\n<p>关于贝叶斯推断的原理部分，今天就讲到这里。下一次，将介绍如何使用贝叶斯推断过滤垃圾邮件。</p>\n<p>（未完待续）\n</p>\n<div>\n<h3>文档信息</h3>\n<ul>\n<li>版权声明：自由转载-非商用-非衍生-保持署名 | <a rel=\"nofollow\" href=\"http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh\">Creative Commons BY-NC-ND 3.0</a></li>\n<li>原文网址：<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_one.html\">http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_one.html</a></li>\n<li>最后修改时间：2011年8月25日 12:36</li>\n<li>付费支持（<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2011/05/my_google_adsense_is_disabled.html\">说明</a>）：<a rel=\"nofollow\" href=\"https://lab.alipay.com/p.htm?id=2011081500435188\"><img alt=\"支付宝担保交易\" src=\"http://chinadigitaltimes.net/chinese/files/2011/08/3a976ef2rmb_32.png.png\" /></a> | <a rel=\"nofollow\" href=\"https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&#038;business=yifeng.ruan@gmail.com&#038;currency_code=USD&#038;amount=0.3&#038;return=http://www.ruanyifeng.com/thank.html&#038;item_name=Ruan%20YiFeng's%20Blog&#038;undefined_quantity=1&#038;no_note=0\"><img alt=\"paypal\" src=\"http://chinadigitaltimes.net/chinese/files/2011/08/5ca83e43dollar_32.png.png\" /></a> </li>\n</ul>\n</div>\n<div>\n<p><a rel=\"nofollow\" href=\"http://www.nanrenwa.com/click/go/ruanyifeng.banner.feed.yfblogfeed/gift\"><img src=\"http://nanrenwa.com/_img/a/2011/yfblog_feed.png\" /></a></p>\n</div>\n<p><img src=\"http://chinadigitaltimes.net/chinese/files/2011/08/395cd295g2011082507.jpg-150x150.jpg\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=738338\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"738338\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":991,"categories":[9203],"tags":[9400]}