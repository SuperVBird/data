{"id":212275,"link":"https://chinadigitaltimes.net/chinese/2012/02/阮一峰-基于用户投票的排名算法（一）：delicious和hacker-news/","date":"2012-02-26T00:16:11Z","modified":"2012-02-26T00:16:11Z","title":"阮一峰 | 基于用户投票的排名算法（一）：Delicious和Hacker News","content":"<p><p>互联网的出现，意味着&#8221;信息大爆炸&#8221;。</p>\n<p>用户担心的，不再是信息太少，而是信息太多。如何从大量信息之中，快速有效地找出最重要的内容，成了互联网的一大核心问题。</p>\n<p><img src=\"http://image.beekka.com/blog/201202/bg2012022401.jpg\" /></p>\n<p>各种各样的排名算法，是目前过滤信息的主要手段之一。对信息进行排名，意味着将信息按照重要性依次排列，并且及时进行更新。排列的依据，可以基于信息本身的特征，也可以基于用户的投票，即让用户决定，什么样的信息可以排在第一位。</p>\n<p>下面，我将整理和分析一些基于用户投票的排名算法，打算分成四个部分连载，今天是第一篇。</p>\n<p><strong>一、Delicious</strong></p>\n<p>最直觉、最简单的算法，莫过于按照单位时间内用户的投票数进行排名。得票最多的项目，自然就排在第一位。</p>\n<p>旧版的<a rel=\"nofollow\" href=\"http://www.google.com/url?sa=D&#038;q=http://del.icio.us/&#038;usg=AFQjCNFp5KllThyYtlA74rqSRKdqRtAjxw\">Delicious</a>，有一个&#8221;热门书签排行榜&#8221;，就是这样统计出来的。</p>\n<p><img src=\"http://image.beekka.com/blog/201202/bg2012022402.png\" /></p>\n<p>它按照<strong>&#8220;过去60分钟内被收藏的次数&#8221;</strong>进行排名。每过60分钟，就统计一次。</p>\n<p>这个算法的优点是比较简单、容易部署、内容更新相当快；缺点是排名变化不够平滑，前一个小时还排在前列的内容，往往第二个小时就一落千丈。</p>\n<p><strong>二、Hacker News</strong></p>\n<p><a rel=\"nofollow\" href=\"http://news.ycombinator.com/\">Hacker News</a>是一个网络社区，可以张贴链接，或者讨论某个主题。</p>\n<p><img src=\"http://image.beekka.com/blog/201202/bg2012022403.png\" /></p>\n<p>每个帖子前面有一个向上的三角形，如果你觉得这个内容很好，就点击一下，投上一票。根据得票数，系统自动统计出热门文章排行榜。但是，并非得票最多的文章排在第一位，还要考虑时间因素，新文章应该比旧文章更容易得到好的排名。</p>\n<p>Hacker News使用Paul Graham开发的Arc语言编写，源码可以从<a rel=\"nofollow\" href=\"http://arclanguage.org/\">arclanguage.org</a>下载。它的排名算法是<a rel=\"nofollow\" href=\"http://pastebin.com/ZF57qQPi\">这样</a>实现的：</p>\n<p><a rel=\"nofollow\" href=\"http://pastebin.com/ZF57qQPi\"><img src=\"http://image.beekka.com/blog/201202/bg2012022404.png\" /></a></p>\n<p>将上面的代码还原为数学公式：</p>\n<p><img src=\"http://chart.googleapis.com/chart?cht=tx&#038;chl=Score%3D%5Cfrac%7BP-1%7D%7B(T%2B2)%5E%7BG%7D%7D&#038;chs=60\" /></p>\n<p>其中，</p>\n<p>　　P表示帖子的得票数，减去1是为了忽略发帖人的投票。</p>\n<p>　　T表示距离发帖的时间（单位为小时），加上2是为了防止最新的帖子导致分母过小（之所以选择2，可能是因为从原始文章出现在其他网站，到转贴至Hacker News，平均需要两个小时）。</p>\n<p>　　G表示&#8221;重力因子&#8221;（gravityth power），即将帖子排名往下拉的力量，默认值为1.8，后文会详细讨论这个值。</p>\n<p>从这个公式来看，决定帖子排名有三个因素：</p>\n<p><strong>第一个因素是得票数P。</strong></p>\n<p>在其他条件不变的情况下，得票越多，排名越高。</p>\n<p><a rel=\"nofollow\" href=\"http://www.wolframalpha.com/input/?i=plot(+(30+-+1)+%2F+(t+%2B+2)%5E1.8%2C++(60+-+1)+%2F+(t+%2B+2)%5E1.8%2C+(200+-+1)+%2F+(t+%2B+2)%5E1.8+)+where+t%3D0..24\"><img src=\"http://image.beekka.com/blog/201202/bg2012022405.png\" /></a></p>\n<p>从<a rel=\"nofollow\" href=\"http://www.wolframalpha.com/input/?i=plot(+(30+-+1)+%2F+(t+%2B+2)%5E1.8%2C++(60+-+1)+%2F+(t+%2B+2)%5E1.8%2C+(200+-+1)+%2F+(t+%2B+2)%5E1.8+)+where+t%3D0..24\">上图</a>可以看到，有三个同时发表的帖子，得票分别为200票、60票和30票（减1后为199、59和29），分别以黄色、紫色和蓝色表示。在任一个时间点上，都是黄色曲线在最上方，蓝色曲线在最下方。</p>\n<p>如果你不想让&#8221;高票帖子&#8221;与&#8221;低票帖子&#8221;的差距过大，可以在得票数上加一个小于1的指数，比如(P-1)^0.8。</p>\n<p><strong>第二个因素是距离发帖的时间T。</strong></p>\n<p>在其他条件不变的情况下，越是新发表的帖子，排名越高。或者说，一个帖子的排名，会随着时间不断下降。</p>\n<p>从前一张图可以看到，经过24小时之后，所有帖子的得分基本上都小于1，这意味着它们都将跌到排行榜的末尾，保证了排名前列的都将是较新的内容。</p>\n<p><strong>第三个因素是重力因子G。</strong></p>\n<p>它的数值大小决定了排名随时间下降的速度。</p>\n<p><a rel=\"nofollow\" href=\"http://www.wolframalpha.com/input/?i=plot%28+%28p+-+1%29+%2F+%28t+%2B+2%29%5E2.0%2C++%28p+-+1%29+%2F+%28t+%2B+2%29%5E1.8%2C+%28p+-+1%29+%2F+%28t+%2B+2%29%5E1.5+%29+where+t%3D0..24%2C+p%3D10\"><img src=\"http://image.beekka.com/blog/201202/bg2012022406.png\" /></a></p>\n<p>从<a rel=\"nofollow\" href=\"http://www.wolframalpha.com/input/?i=plot%28+%28p+-+1%29+%2F+%28t+%2B+2%29%5E2.0%2C++%28p+-+1%29+%2F+%28t+%2B+2%29%5E1.8%2C+%28p+-+1%29+%2F+%28t+%2B+2%29%5E1.5+%29+where+t%3D0..24%2C+p%3D10\">上图</a>可以看到，三根曲线的其他参数都一样，G的值分别为1.5、1.8和2.0。G值越大，曲线越陡峭，排名下降得越快，意味着排行榜的更新速度越快。</p>\n<p>知道了算法的构成，就可以调整参数的值，以适用你自己的应用程序。</p>\n<p><strong>[参考文献]</strong></p>\n<p>　　* <a rel=\"nofollow\" href=\"http://amix.dk/blog/post/19574\">How Hacker News ranking algorithm works</a></p>\n<p>　　* <a rel=\"nofollow\" href=\"http://blog.linkibol.com/2010/05/07/how-to-build-a-popularity-algorithm-you-can-be-proud-of/\">How to Build a Popularity Algorithm You can be Proud of</a></p>\n<p>（完）</p>\n<div>\n<h3>文档信息</h3>\n<ul>\n<li>版权声明：自由转载-非商用-非衍生-保持署名 | <a rel=\"nofollow\" href=\"http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh\">Creative Commons BY-NC-ND 3.0</a></li>\n<li>原文网址：<a rel=\"nofollow\" href=\"http://www.ruanyifeng.com/blog/2012/02/ranking_algorithm_hacker_news.html\">http://www.ruanyifeng.com/blog/2012/02/ranking_algorithm_hacker_news.html</a></li>\n<li>最后修改时间：2012年2月24日 21:50</li>\n<li>付费支持：<a rel=\"nofollow\" href=\"https://mai.alipay.com/p.htm?id=2012010602227616\"><img alt=\"支付宝担保交易\" src=\"http://chinadigitaltimes.net/chinese/files/2012/02/3a976ef2rmb_32.png.png\" /></a> | <a rel=\"nofollow\" href=\"https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&#038;business=yifeng.ruan@gmail.com&#038;currency_code=USD&#038;amount=2.99&#038;return=http://www.ruanyifeng.com/thank.html&#038;item_name=Ruan%20YiFeng's%20Blog&#038;undefined_quantity=1&#038;no_note=0\"><img alt=\"paypal\" src=\"http://chinadigitaltimes.net/chinese/files/2012/02/5ca83e43dollar_32.png.png\" /></a> </li>\n</ul>\n</div>\n<div>\n</div>\n<p><img src=\"http://chinadigitaltimes.net/chinese/files/2012/02/bee3c876g2012022401.jpg-150x150.jpg\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"450\" height=\"309\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=738338\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"738338\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":999,"categories":[9203],"tags":[9400]}