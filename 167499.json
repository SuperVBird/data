{"id":167499,"link":"https://chinadigitaltimes.net/chinese/2011/07/vpn自动连接自动修改访问国内网站路由/","date":"2011-07-17T05:00:19Z","modified":"2011-07-17T05:00:19Z","title":"VPN自动连接+自动修改访问国内网站路由","content":"<div>\n<div>\n<div>\n<div>\n<p>来源：<a href=\"http://fprint.org/index.php/2011/07/16/vpn%E8%87%AA%E5%8A%A8%E8%BF%9E%E6%8E%A5%E8%87%AA%E5%8A%A8%E4%BF%AE%E6%94%B9%E8%AE%BF%E9%97%AE%E5%9B%BD%E5%86%85%E7%BD%91%E7%AB%99%E8%B7%AF%E7%94%B1/\">http://fprint.org/index.php/2011/07/16/vpn%e8%87%aa%e5%8a%a8%e8%bf%9e%e6%8e%a5%e8%87%aa%e5%8a%a8%e4%bf%ae%e6%94%b9%e8%ae%bf%e9%97%ae%e5%9b%bd%e5%86%85%e7%bd%91%e7%ab%99%e8%b7%af%e7%94%b1/</a>            </p>\n<p>参考：<a href=\"http://chinanetblog.blogspot.com/2011/06/gfw-blog-pptp-vpn-vpn.html\">http://chinanetblog.blogspot.com/2011/06/gfw-blog-pptp-vpn-vpn.html</a> </p>\n<p><span></span></p>\n<p>测试环境：             <br />服务器：linode VPS pptpd VPN              <br />客户端：windows7 </p>\n<p>我在linode买的VPS差不多也用了半年了，目前的主要用途就是搭建了此博客，还装了VPN用来穿墙。作为一个有志青年，不会穿墙，不能穿墙都是痛苦 的。于是，需要用facebook、twitter及其他一些被pingbi的网站时候就连上VPN，不用了就断开。开始感觉还蛮好，但是等新鲜感过去之 后，觉得这太麻烦了，浪费时间又消耗流量（linode每个月流量是有限制的），有些网站访问很慢，跟传说中的VPN速度不相符，很慢，而且有些国外网站 和国内网站无法访问，当然这是配置的问题，我将单独出文记录。 </p>\n<p>很早就知道了这个项目，这个项目主要是为了身在国内，穿墙访问国外资源的用户，再访问国内资源时更变得更方便。用过你就知道这些原因主要是：1.穿 墙之后数据传输距离远了，网络速度就慢了；2.国内的一些网站屏蔽了国外IP，而你穿墙之后用的肯定是国外IP；3.一般VPN都有流量，你电脑访问的所 有流量都将算入VPN服务器的流量。通过修改路由表，这三种问题都可以得到解决。</p>\n<p>除了这些，还有我上面提到的VPN自动启动的问题，都将在此一并解决。</p>\n<h5>一、准备文件</h5>\n<p>从chnroutes网站下载名为&#8221;pre_created_for_win&#8221;的压缩文件，解压，得到四个文件：vpnup.bat,vpnup.vbs,vpndown.bat,vpndown.vbs。这里两个vbs文件作用不大，可以删除。</p>\n<h5>二、修改文件</h5>\n<p>用Notepad++编辑vpnup.bat文件。将文件中gw变量赋值为以太网出口网关。在route add语句之前添加             <br /><code>               <br />set gw=\"你的网关地址\"                <br /></code>              <br />网关地址可以通过在命令提示符下输入：ipconfig查看，我的网关地址为192.168.0.1。修改完文件注意保存。 </p>\n<h5>三、VPN自动连接</h5>\n<p>接着第二步，在vpnup.bat文件的末尾添加语句             <br /><code>               <br />rasdial \"你的PPTP VPN 连接名称\" \"VPN用户名\" \"VPN密码\"                <br /></code>              <br />保存文件。如果只进行到这里，那么你的连接很可能不会成功。因为你之前很可能已经建立过一个VPN连接，而你不清楚用户名是什么，或者是你建立了多个VPN，连接时到底连接哪个呢？直接用管理员的权限运行vpnup.bat文件后，可能会出现如下不成功信息：              <br /><code>               <br />Remote Access error 623 - The system could not find the phone book entry for this connection.                <br /></code>              <br />这多半是因为你在bat里的连接名称跟现有VPN的连接名称不相同。最好的办法就是新建一个VPN，名称和文件里的保持一致。 </p>\n<p>如果有多个VPN连接怎么办呢？那就需要多设置一步。开始>>控制面板>>网络和 Internet 连接 >>网络连接>>（其他VPN连接）>>右键点击>>属性>>单击先拨另一个连接复选框， 然后选择你新建的自动拨号的VPN。</p>\n</div>\n</div>\n</div>\n</div>\n<p>  <a href=\"http://feeds.wordpress.com/1.0/gocomments/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/comments/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godelicious/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/delicious/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gofacebook/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/facebook/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gotwitter/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/twitter/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gostumble/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/stumble/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godigg/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/digg/xijie.wordpress.com/4755/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/goreddit/xijie.wordpress.com/4755/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/reddit/xijie.wordpress.com/4755/\" /></a> <img alt=\"\" border=\"0\" height=\"1\" src=\"http://stats.wordpress.com/b.gif?host=xijie.wordpress.com&#038;blog=10068099&#038;post=4755&#038;subd=xijie&#038;ref=&#038;feed=1\" width=\"1\" /></p>\n<p><img src=\"http://feeds.wordpress.com/1.0/comments/xijie.wordpress.com/4755/\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=750556\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"750556\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":133,"categories":[15300],"tags":[8510,8795]}