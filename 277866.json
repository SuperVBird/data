{"id":277866,"link":"https://chinadigitaltimes.net/chinese/2013/02/翻墙-解决最近gfw升级导致vpn失效问题/","date":"2013-02-05T01:30:31Z","modified":"2017-12-06T03:49:37Z","title":"翻墙 | 解决最近GFW升级导致VPN失效问题","content":"<p><span></p>\n<blockquote>\n<p>最近，公司的VPN总是掉线，后来才看到，方校长的研究文章。<a rel=\"nofollow\" target=\"_blank\" href=\"http://yes2.me/wp-content/uploads/2012/12/%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E5%88%86%E7%B1%BB%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95%E4%B8%8E%E5%B1%95%E6%9C%9B.pdf\">「网络流量分类研究进展与展望 」</a>。通过机器学习的方法封锁翻墙了。SSH隧道、IPSEC隧道、SSL, 以及P2P均被破解。无论如何换端口或者ip，只要流量稍大一点，就立刻掉线。</p>\n</blockquote>\n<p>研究了几天后，终于找到对策：VPN通过SSH隧道映射穿越GFW。该方法可以绕过企业级的防火墙，同样，绕过GFW似乎也非常好使。下面简单说说配置的过程。</p>\n<p>基本原理： 客户端 –> 本地映射端口 <-- SSH隧道 --> 远程VPN服务器</p>\n<h3>前期准备</h3>\n<p>1、可以翻墙的SSH账户(最好和VPN在一台主机上)</p>\n<p>2、可以翻墙的VPN账户(openVPN、pptp 等)</p>\n<h3>配置方法</h3>\n<p>1、本地设置端口转发的脚本并运行</p>\n<pre><code>#! /usr/bin/env python  #coding=utf-8    import pexpect  import re  local_port = \"本地转发端口\"   #pptp默认是1723 openVPN默认是1194  username = \"ssh用户名\"       password = \"ssh密码\"                ssh_host = \"ssh的地址\"  vpn_host = \"vpn的地址\"     #如果ssh和vpn是一台机子，这里可以是127.0.0.1  vpn_port = \"vpn端口\"  cmd = \"ssh  -C -f -N -g -o CompressionLevel=9 -o Cipher=none \"  cmd += username + \"@\" + ssh_host + \" -L \"  cmd += local_port +\":\"+ vpn_host + \":\" + vpn_port  pattern = re.compile(\"^.*assword:s*\")  child = pexpect.spawn(cmd)  child.expect(pattern)  child.sendline(password)  child.expect(pexpect.EOF)  </code></pre>\n<p>2、设置VPN的地址和端口到本地映射地址</p>\n<p>按照上面脚本，如果是openVPN，那么连接的地址应该是127.0.0.1:1194。</p>\n<p>3、特别注意</p>\n<p>由于SSH端口转发不支持UDP，所以openVPN要把连接方式改成TCP的才能顺利连接。 上面是简单的介绍，如果还有疑问可以在微博私信我。</p>\n<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://feedproxy.google.com/~r/Yes2Me/~3/voHwD8KA9y8/1577\">Yes2Me</a></span></p>\n<div>获取最新穿墙软件？请发电邮（最好用gmail）到：cdtcaonima@gmail.com。《中国数字时代》开通IPv6，欢迎穿墙阅读。翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\n\n\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a></div>\n</p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?hl=zh-CN&#038;formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"510\" height=\"328\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=2ea93c5b7b\">\n<a href=\"http://eepurl.com/msuvD\">墙外新闻实时更新 欢迎订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1005,"categories":[18269,15300],"tags":[7775,33607]}