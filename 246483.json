{"id":246483,"link":"https://chinadigitaltimes.net/chinese/2012/08/翻墙-如何本地避免gfw的dns污染/","date":"2012-08-11T02:15:16Z","modified":"2012-08-11T02:15:16Z","title":"翻墙 | 如何本地避免GFW的DNS污染","content":"<p><p>最近看了 IGFW 上的<a rel=\"nofollow\" target=\"_blank\" href=\"http://igfw.net/archives/10856\">如何不受DNS污染</a>，讲的是做VPN服务器的VPS 配置方法。我来说下目前我知道的各平台上，本地避免DNS 污染的方法。</p>\n<div>\n<p>DNS污染的原理部分，参考这篇 <a rel=\"nofollow\" target=\"_blank\" href=\"http://gfwrev.blogspot.com/2009/11/gfwdns.html\">深入理解GFW：DNS污染</a>。本地避免污染，有两个思路：</p>\n<ol>\n<li>通过加密方式，查询可信的DNS服务器</li>\n<li>设置国外DNS服务器，并丢弃GFW DNS伪包</li>\n</ol>\n<p>第一种思路下，目前比较靠谱的是 <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.opendns.com/technology/dnscrypt/\">DNSCrypt</a>，支持Windows （<a rel=\"nofollow\" target=\"_blank\" href=\"http://shared.opendns.com/dnscrypt/packages/windows-client/DNSCryptWin-v0.0.5.exe\">下载</a>）和 Mac（<a rel=\"nofollow\" target=\"_blank\" href=\"http://shared.opendns.com/dnscrypt/packages/osx-client/dnscrypt-osx-client.pkg\">下载</a>）。DNSCrypt 使用很方便，把 Enable OpenDNS、Enable DNSCrypt 全勾上就好，也建议勾上 Fallback to insecure DNS。</p>\n<p>第二种方式，Windows上不好弄。Mac 和 Linux 都有办法实现。前提是设置国外DNS，继续推荐台湾中华电信的168.95.1.1 。然后：</p>\n<ul>\n<li>Mac：安装 kernet 内核扩展（<a rel=\"nofollow\" target=\"_blank\" href=\"https://github.com/downloads/liruqi/kernet/Kernet-stable-20120806.zip\">下载</a>），我自己做的，开机自启动，风险自负。</li>\n<li>Linux：西厢计划项目做了这一部分，不过编译内核模块毕竟麻烦。2.6.33.7 以上版本的内核（不保证这是最低版本），依赖 iptables 1.4.10，都会自带u32 模块，可以用iptables 规则做丢弃GFW DNS伪包：\n<pre>iptables -I INPUT -p udp -m udp –sport 53 -m u32 –u32 “0&0x0F000000=0×05000000 && 22&0xFFFF@16=0x5d2e0859,0xcb620741,0x0807c62d,0x4e10310f,0x2e52ae44,0xf3b9bb27,0xf3b9bb1e,0x9f6a794b,0x253d369e,0x9f1803ad” -j DROP iptables -I INPUT -p udp -m udp –sport 53 -m u32 –u32 “0&0x0F000000=0×05000000 && 22&0xFFFF@16=0x3b1803ad” -j DROP</pre>\n<p>设置联网自动加载iptables 配置：Ubuntu下，可以把以上规则写入 /etc/network/if-pre-up.d/iptablesload 文件。其它Linux发行版应该也有类似的方法。强烈建议淘宝上卖自制路由器的同学们，把这个防火墙规则写到路由器中，也能多一个卖点。</p>\n</li>\n</ul>\n<p>另外，继续推荐<a rel=\"nofollow\" target=\"_blank\" href=\"http://igfw.net/\">IGFW博客</a>。顺便推广下自己做的 <a rel=\"nofollow\" target=\"_blank\" href=\"http://igfw.sinaapp.com/\">IGFW墙内镜像</a>，有点慢，日独立IP过1000我就做服务器缓存（目前已经到500）。</p>\n<p><strong>原文</strong>：<a rel=\"nofollow\" target=\"_blank\" href=\"http://liruqi.info/post/28775426009/how-to-avoid-dns-hijack-locally\">http://liruqi.info/post/28775426009/how-to-avoid-dns-hijack-locally</a></p>\n<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://igfw.net/archives/10890\">http://igfw.net/archives/10890</a></p>\n</div>\n<div>请点击<a rel=\"nofollow\" target=\"_blank\" href=\" https://mycdt0.info\"> https://mycdt0.info</a>，穿墙访问《中国数字时代》（当看到“此网站的安全证书有问题”的提示时，请选择“继续浏览此网站(不推荐)”，忽略证书警告并继续访问网站）。《中国数字时代》开通IPv6，欢迎穿墙阅读。翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\n\n\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5500297126185736776-1105815646238249545?l=www.chinagfw.org\" alt=\"\" /></div>\n</p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?hl=zh-CN&#038;formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"510\" height=\"328\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=b4fd4ae247\">\n定期获得翻墙信息？<a href=\"http://eepurl.com/mstlf\">请电邮订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1005,"categories":[18269,15300],"tags":[7775,8795,8817]}