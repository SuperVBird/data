{"id":552842,"link":"https://chinadigitaltimes.net/chinese/2017/02/gfw-blog-科学上网二三事/","date":"2017-02-26T15:00:47Z","modified":"2017-02-26T15:00:47Z","title":"GFW Blog | 科学上网二三事","content":"<div><a href=\"https://2.bp.blogspot.com/-yvo0VEH9A6M/WLJFFXw8iMI/AAAAAAAADkY/cYJHSb3gkfIOzJ53tiHEXDL3g_csV-7SACLcB/s1600/mac-4591961.jpg\"><img src=\"https://2.bp.blogspot.com/-yvo0VEH9A6M/WLJFFXw8iMI/AAAAAAAADkY/cYJHSb3gkfIOzJ53tiHEXDL3g_csV-7SACLcB/s640/mac-4591961.jpg\" width=\"640\" height=\"396\" border=\"0\" /></a></div>\n<p>因为一些众所周知的原因，国外一些很棒的服务和网站在我国无法正常访问，例如 Google。但“无法正常访问”不代表“无法访问”。<br />\n<a name=\"more\"></a><br />\n来源：<a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/\">科学上网二三事 2</a></p>\n<p>通过使用代理服务器可实现穿透防火长城（GFW）<a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#fn1\">1</a>，访问被屏蔽的网络和服务的目的，即我们所说的<strong>“科学上网”</strong>。常见的科学上网方式包括：</p>\n<ul>\n<li>VPN（虚拟专用网络）</li>\n<li>shadowsocks 及相关衍生项目（如 SSR 等）</li>\n<li>其它方式（如修改 host、DNS 等方式）</li>\n</ul>\n<div>VPN 是最常见的科学上网方式，几乎所有设备、所有操作系统都提供了 VPN 连接服务，毕竟 VPN 最原始的目的并不是用来科学上网<a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#fn2\">2</a>，但也因此提供了相当的便利性。但 VPN 也并非十全十美，对新手而言，VPN 最大的局限性在于不能方便地对 IP 进行分流（分流直连与限制的 IP），另外在自动连接方面 VPN 也不是很便利（包括 Mac 和 iOS 平台都不能很方便地实现自动连接）。</div>\n<div></div>\n<div><a href=\"https://shadowsocks.org/\">shadowsocks</a> 是一款轻量级 Socks5 代理，拥有体积小、速度快、抗干扰能力强的特性，是目前主流的翻墙方式，平台支持广泛，在 iOS9 开放了 Network-Extension<a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#fn3\">3</a> 权限之后，iOS 平台也有了免越狱的 shadowsocks 代理方案。同时，shadowsocks 提供了代理规则设置，以区分需要代理的网址 IP 和不需要代理的网址 IP。</div>\n<div>至于其他方案，例如修改 host、DNS 等方式，由于 GFW 封锁能力的提升，可以对科学上网起到辅助作用，但无法作为日常使用的方案（毕竟时不时就会挂掉）。</div>\n<h2>Mac 翻墙方案总结</h2>\n<div></div>\n<div>作为一台电脑，翻墙方式多种多样，从最初的 VPN、OpenVPN，到现在的 shadowsocks，都有非常成熟的方案。最初我采用的是 VPN 配合路由表的方式翻墙，也大概实现了 IP 分流的效果，但是 VPN 在 Mac 上非常容易断，受网络条件影响，后来使用 OpenVPN，稳定性要好很多。期间采用了很多方法来实现自动化，比如通过判断网络情况来自动连接 VPN，每周固定时间生成新的路由表等，后来有了 SS，VPN 的方案就不再使用了。</div>\n<div>用 SS 没那么多折腾的过程，直接下载 SS 应用，填上服务器和密码，然后选择基于 gfwlist 的 pac 就可以了，一直用着都没什么问题，国内外自动分流，速度也很理想，用了很长一段时间。中途 gfwlist 的地址从 googlecode 迁移到 <a href=\"https://github.com/gfwlist/gfwlist\">github</a>，而 SS 应用内 gfwlist 的获取地址仍然是 googlecode 的地址，从 github 下载了一个脚本，每周定时更新 pac。</div>\n<div>期间出了一起 Dropbox 和 Gmail 的连接事故，具体可见我的博文《<a href=\"https://boyux.com/2016/07/31/dropbox-%E5%92%8C-gmail%EF%BC%9A%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98%E5%92%8C%E6%9B%B4%E6%94%B9%E6%96%B9%E5%BC%8F/\">Dropbox 和 Gmail：解决问题和更改方式</a>》，由 SS 换到了 GoAgentX + Proxifier，Proxifier 可以根据<strong>应用</strong>、IP、域名进行分流，并且可以选择不同的节点。但问题在于没有成熟的脚本化规则导入的方案，从网上下载了一个基于地理位置的 IP 规则，但需要手动复制粘贴导入，很麻烦。Proxifier 的方案用了将近一个月，满分 10 分给 7 分。</div>\n<div>后来在网上了解到 <a href=\"https://github.com/cyfdecyf/cow\">COW</a>，拥有自动探测网站是否被屏蔽的功能，COW 的介绍是：</div>\n<blockquote>\n<div>COW 的设计目标是自动化，理想情况下用户无需关心哪些网站无法访问，可直连网站也不会因为使用二级代理而降低访问速度。</div>\n</blockquote>\n<div>COW 是一个 HTTP(S) 代理，能最大程度兼容各种软件（可以设置为程序代理）和设备（设置为系统全局代理）。实际使用上，除了第一次连接需判断网站时会花费一点事件来检测网站是否被墙，其他时候 COW 的连接速度都非常理想，不比 SS 慢多少，COW 也有一些 SS 没有的特性，例如 <strong>设置多个二级代理</strong>，多个二级代理的设定与 Surge 的 Proxy Group 类似，COW 可以在多个二级代理中选择延迟最小的代理进行连接。但目前我所用的设定是固定连接到一台装有 COW 的服务器，当服务器不可用时，再连接到备用的 SS 节点。</div>\n<div>使用 COW 的另一个优点在于，不用设置复杂的规则，COW 自己判定网站是否被墙，决定是否使用代理，免去了更新和维护规则的工作。</div>\n<div>目前我仍然使用 COW 作为电脑端的代理，速度和稳定性非常满意，还未发现特别明显的缺点。</div>\n<h2>iOS Apps &amp; Rules</h2>\n<div></div>\n<div>iOS 一直以来都支持 VPN（基本所有设备都支持 VPN），但 iOS 的 VPN，限制很多，即使使用类似 Cisco Anyconnect 这样的应用，仍然无法保证 VPN 的稳定使用，还不支持分流。</div>\n<div>后来某些代理供应商推出了一系列针对 iOS 的代理解决方案，在 WiFi 环境下，使用 PAC 代理方式，在蜂窝网络环境下，通过描述性文件的方式，为数据网络添加 HTTP 代理。局限性在于，某些采用 SPDY 方式连接的应用无法通过代理连接（不过现在基本已经没有了）。</div>\n<div>在 iOS 9 之前，通过越狱来实现稳定的翻墙方案，最早的有 GoAgent（就是那个把整个 Python 都搬到 iOS 上的方式），后来使用越狱版 shadowsocks，支持代理规则和分应用代理，但 Cydia 上的 shadowsocks 已经有两年没有维护了，iOS 9 以后已经无法正常使用。</div>\n<div>iOS9 之后 Apple 开放了 NE 权限，SS 得以在 iOS 上实现，iOS 上最早的 SS 代理是“备受争议”的 <a href=\"http://nssurge.com/\">Surge</a>。后来 NE 类 App 百花齐放，有了 <a href=\"https://itunes.apple.com/cn/app/shadowrocket/id932747118?mt=8\">ShadowRocket</a> 和 <a href=\"https://itunes.apple.com/us/app/tu-dou-si-potatso-qiang-da/id1070901416?mt=8\">Potatso</a>，然后是 <a href=\"https://itunes.apple.com/cn/app/id1178584911\">Wingy</a>。</div>\n<div>我最先买了 SR 和 Potatso，最初的 SR 稳定性不好，经常出现掉线的情况，于是转而使用 Potatso，但 Potatso 也有一些小问题，DNS 解析无效，某些规则无法生效等，比如微信朋友圈图片刷不出等。后来 SR 的作者（的老婆）孩子生完，像打了鸡血一样更新 SR，从功能到稳定性再到界面基本都重做了一番，当然价格也涨了，在 Potatso 作者撸 2 代而不管 1 代死活的时候，我从 Potatso 转到了 SR。</div>\n<div>在 SR 的规则上浪费了不少时间，一开始使用内置的规则，但这个 Default 规则很奇怪的一点在于，既包括了常用的被墙网站走代理的规则，又包括了常见国内网站直连的规则，最后还来一个 Final Proxy，不是很理解作者的逻辑。后来上网找了一个精简版 + 广告屏蔽的规则，本来用的挺好，但有一次打开网易严选，图片刷不出来。再然后使用了由 gfwlist 转换过来的规则，但 gfwlist 里无效规则非常多，效率很低。所以最后的最后，我把规则做了一下减法，保留两条规则：</div>\n<pre><code>GEOIP CN, Direct\r\nFinal, Proxy\r\n</code></pre>\n<div>简单粗暴，目前用着还没出现什么奇奇怪怪的现象。</div>\n<div>另：事实证明，通过 SR 这类应用来屏蔽广告，真的没什么用。</div>\n<h2>Android</h2>\n<div></div>\n<div>Android 上从很早开始就有了 <a href=\"https://github.com/shadowsocks/shadowsocks-android\">SS for Android</a> 应用，稳定性和功能都非常完善，而且还在不断更新。</div>\n<div>说一个 Android 上的小故事：</div>\n<div>在更早以前，还没有 SS 的时候，翻墙还是通过 VPN 的方式，2.2、2.3 时代的 Android，没有一键启动 VPN 的工具，而每次到系统设置里启动，都需要输入 VPN 密码。于是 Google Play 上出现了一款小工具，旨在帮你快速连接 VPN，其步骤是这样的：</div>\n<ol>\n<li>在软件里预先设置好你的 VPN 密码；</li>\n<li>点击“连接”，软件复制 VPN 密码，然后跳转到系统 VPN 界面；</li>\n<li>点击要连接的 VPN，长按粘贴密码，然后连接。</li>\n</ol>\n<div>有点不知道说什么好，其实这个工具我用了挺长时间的。</div>\n<h2>Windows</h2>\n<div></div>\n<div>一直用的是 <a href=\"https://github.com/shadowsocks/shadowsocks-windows\">SS for Windows</a>，似乎也没什么可说的，当然也可以使用 COW。</div>\n<hr />\n<ol>\n<li>详见 <a href=\"https://en.wikipedia.org/wiki/Great_Firewall\">Great Firewall – Wikipedia</a> <a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#ffn1\"><img draggable=\"false\" src=\"https://s0.wp.com/wp-content/mu-plugins/wpcom-smileys/twemoji/2/svg/21a9.svg\" alt=\"↩\" /></a></li>\n<li>详见 <a href=\"https://en.wikipedia.org/wiki/Virtual_private_network\">Virtual private network – Wikipedia</a> <a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#ffn2\"><img draggable=\"false\" src=\"https://s0.wp.com/wp-content/mu-plugins/wpcom-smileys/twemoji/2/svg/21a9.svg\" alt=\"↩\" /></a></li>\n<li>详见 <a href=\"https://developer.apple.com/reference/networkextension\">NetworkExtension | Apple Developer Documentation</a> <a href=\"https://boyux.com/2016/12/18/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%BA%8C%E4%B8%89%E4%BA%8B-2/#ffn3\"><img draggable=\"false\" src=\"https://s0.wp.com/wp-content/mu-plugins/wpcom-smileys/twemoji/2/svg/21a9.svg\" alt=\"↩\" /></a></li>\n</ol>\n<div>翻墙技术博客<a href=\"http://www.chinagfw.org/2013/09/blog-post.html\">订阅地址及社交帐号</a></div>\n<p>请在<a href=\"http://onlineapk.com/download-freebrowser-apk/\">这里</a>下载FreeBrowser，将它的APK文件下载到本地然后传到手机中安装，即可翻墙。</p>\n","author":1005,"categories":[18270,18269,10466,15300],"tags":[7775,28377,18544]}