{"id":250882,"link":"https://chinadigitaltimes.net/chinese/2012/09/翻墙-多域名对应同一网站、跳转的三种方法及泛/","date":"2012-09-09T14:15:14Z","modified":"2012-09-09T14:15:14Z","title":"翻墙 | 多域名对应同一网站、跳转的三种方法及泛域名设置","content":"<p><p>不断有朋友在博客问关于多个域名指向同一网站的问题，按说这是一个很基础很简单的问题，但对新手来说，可能有些误解，我在这里详细说下。<br />这里多个域名指向同一网站，是指裸域名（root domain）和其他如带www的域名指向同一网站。如输入<a rel=\"nofollow\" target=\"_blank\" href=\"http://abc.com\">abc.com</a>或者<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.abc.com\">www.abc.com</a>，都是访问<a rel=\"nofollow\" target=\"_blank\" href=\"http://abc.com\">abc.com</a>，正如本博客一样；或者输入<a rel=\"nofollow\" target=\"_blank\" href=\"http://abc.com\">abc.com</a>或者<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.abc.com\">www.abc.com</a>，都是访问<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.abc.com\">www.abc.com</a>，如淘宝。<br /> 还有一种输入<a rel=\"nofollow\" target=\"_blank\" href=\"http://abc.com\">abc.com</a>或者<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.abc.com\">www.abc.com</a>，不跳转，但网页内容是一致的，如广告中国（<a rel=\"nofollow\" target=\"_blank\" href=\"http://advertcn.com\">advertcn.com</a>）。</p>\n<p> 首先，说点基础知识。当一个人访问一个网站，<br />第一步你的电脑要到这个域名的dns服务器去把域名换成相应的ip，因为ip才是互联网真正的地址和门牌号，域名只不过是方便记忆的别名而已。（中间可能还有dns缓存服务器的过程）；<br />第二步，你的电脑将访问网站的请求发送你的网站服务器，我们的一键包中nginx就是专门处理这种请求的，它根据发来的数据进行处理；<br />第三步，如果是静态网站，就直接在服务器上读取相应文件的数据（如果是动态的，就将请求数据发送到如php处理后再获取数据），发送给你的电脑浏览器，浏览器将数据解析，然后就展现了缤纷丰富的网页。</p>\n<p>那么，如果出现问题，就应该根据相应错误，在这三个方面进行排除，找到正确的地方进行处理。</p>\n<p> 如果多个域名指向同一网站出问题，在排除dns设置出错之后，一般问题都出在nginx的配置上。<br />一般dns设置添加www为aname，指向根域名的同一ip（或者设置www的cname为@）<br /><img src=\"http://actgod.com/uploads/image/20120429/20120429134036_68945.png\" alt=\"\" /></p>\n<p> 那么，有这么几种设置方法，供参考：<br /><strong>1、多个域名指向同一网站，并301跳转。推荐用这个方法。</strong><br /><img src=\"http://actgod.com/uploads/image/20120429/20120429134325_86389.png\" alt=\"\" /></p>\n<p> 比如我的博客<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>，nginx的设置是这样的：<br /><code>vim /etc/nginx/sites-enabled/actgod.com.conf</code> 修改其中这一部分，其他照旧<br /><code>server_name <a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a> <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com\">www.actgod.com</a> *.<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>;<br /> root /var/www/<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>;<br />if ( $host != \"<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>\" ) <br />rewrite ^/(.*)$ <a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com/$1\">http://actgod.com/$1</a> permanent;<br /> </code><br />如果是想实现淘宝的那种跳转：<br /><code>server_name <a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a> <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com\">www.actgod.com</a> *.<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>;<br />root /var/www/<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com\">www.actgod.com</a>;<br /> if ( $host != \"<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com\">www.actgod.com</a>\" ) <br />rewrite ^/(.*)$ <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com/$1\">http://www.actgod.com/$1</a> permanent;<br /></code><br />修改好后，重新加载配置：<br /><code>invoke-rc.d ngxin reload</code><br /> <strong>2、多个域名指向同一网站，使用refresh跳转，百度是用的这个方法，也就是输入<a rel=\"nofollow\" target=\"_blank\" href=\"http://baidu.com\">baidu.com</a>自动跳转到<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.baidu.com\">www.baidu.com</a>，但没用301跳转。</strong><br />首先用<br /><code>bash damnp-actgod.sh dhost <a rel=\"nofollow\" target=\"_blank\" href=\"http://yourdomain.com\">yourdomain.com</a></code> 建一个空的虚拟主机。在此虚拟主机目录下新建一个index.html<br /> <code>vim /var/www/<a rel=\"nofollow\" target=\"_blank\" href=\"http://yourdomain.com/index.html\">yourdomain.com/index.html</a></code> 内容如下：<br /><code><html><br /><meta http-equiv=\"refresh\" content=\"0;url=<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.yourdomain.com/\">http://www.yourdomain.com/</a>\"><br /> </html></code></p>\n<p><img src=\"http://actgod.com/uploads/image/20120429/20120429133430_92589.png\" alt=\"\" /></p>\n<p> 这种方法，一般来说不如第一种的，特别是从seo的方面考虑，同时需要多加载一个index，速度也有影响，虽然微乎其微。</p>\n<p><strong>3、广告中国那种不跳转，只需要修改配置：</strong><br /><code>vim /etc/nginx/sites-enabled/actgod.com.conf<br /> server_name 后面添加多个域名即可，其他不用改。<br />server_name <a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a> <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.actgod.com\">www.actgod.com</a> *.<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>;</code><br />最后说下泛域名解析指向同一个网站。<br />也就是输入任何<a rel=\"nofollow\" target=\"_blank\" href=\"http://xxx.actgod.com\">xxx.actgod.com</a>都指向<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>，只需要在dns服务器设置 * 的aname为根域名同一ip，server_name 后面加上*.<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com\">actgod.com</a>即可。如果要跳转，同上设置。</p>\n<p><strong>原文</strong>：<a rel=\"nofollow\" target=\"_blank\" href=\"http://actgod.com/archives/92/\">http://actgod.com/archives/92/</a></p>\n<p>原文：<a rel=\"nofollow\" target=\"_blank\" href=\"http://igfw.net/archives/11536\">http://igfw.net/archives/11536</a></p>\n<div>获取最新穿墙软件？请发电邮（最好用gmail）到：cdtcaonima@gmail.com。《中国数字时代》开通IPv6，欢迎穿墙阅读。翻越防火长城，你可以到达世界上的每一个角落。（Across the Great Firewall, you can reach every corner in the world.）翻墙利器赛风3下载地址：<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima326\n\n\"> http://dld.bz/caonima326</p>\n<p></a>，<a rel=\"nofollow\" target=\"_blank\" href=\"http://dld.bz/caonima745\">http://dld.bz/caonima745</a><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5500297126185736776-2778391795736006072?l=www.chinagfw.org\" alt=\"\" /></div>\n</p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<p><iframe src=\"https://docs.google.com/spreadsheet/embeddedform?hl=zh-CN&#038;formkey=dGRpN3FrVThuMFFsZHBZcmNGLW94dEE6MQ\" width=\"510\" height=\"328\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\">Loading&#8230;</iframe></p>\n<form method=\"POST\" action=\"http://chinadigitaltimes.us4.list-manage.com/subscribe/post?u=17daa75df533f6c6ff72e51ab&#038;id=b4fd4ae247\">\n<a href=\"http://eepurl.com/mstlf\">墙外新闻实时更新 欢迎订阅数字时代</a><br />\n <br /><input type=\"email\" value=\"\" name=\"EMAIL\" id=\"mce-EMAIL_in_post\" size=\"25\" style=\"display:block;\" placeholder=\"请输入您的邮件地址\" required><br />\n\t<input type=\"submit\" value=\"点击订阅\" name=\"subscribe\" style=\"height: 20px;\" id=\"in_post_subscribe\"><br />\n</form>\n","author":1005,"categories":[18269,15300],"tags":[7775,8795]}