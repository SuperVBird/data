{"id":140720,"link":"https://chinadigitaltimes.net/chinese/2011/03/解决dropbox无法实时更新的问题/","date":"2011-03-20T11:30:11Z","modified":"2011-03-20T11:30:11Z","title":"解决Dropbox无法实时更新的问题","content":"<p><p>　　本文背景是，中国到<a href=\"http://www.williamlong.info/archives/2044.html\">dropbox</a>的http连接会被重置，但是https连接不受影响。如果背景改变了，则本文失效。本文主题是让dropbox客户端的http请求经socks代理访问dropbox服务器，而https请求不经代理直接访问，用这种方法来解决Dropbox客户端目前无法实时更新的问题。</p>\n<p>　　现象：在国内的多个电脑客户端使用同一个Dropbox帐号登录，实现协同办公等操作，但是一台电脑更新文件后，无法实时同步到其他电脑客户端。而在国外的网络环境没有这种现象。</p>\n<p>　　原因：目前在国内，dropbox被<a href=\"http://www.williamlong.info/archives/2173.html\">关键字屏蔽</a>（Wildcard: .dropbox.com），但是客户端还能正常使用，因为客户端和服务器之间使用的是https加密传输。但只有一处是没有使用https的，就是 stork47.dropbox.com（笔者是这个地址，其他地方可能不一样）。这个服务器负责将服务器端（或其他客户端）发生的文件更新通知到其他客户端（笔者猜的，但应该差不多），然后其他客户端才会发起https请求去和服务器同步这些文件。实际中，是客户端每60秒向 stork47.dropbox.com查询一次，看是否有文件需要更新。因为该请求没有使用https连接，导致连接一直被RESET，所以某台客户端的更新无法实时反映到其他客户端。</p>\n<p>　　因为一般人可能没有这个需求，所以没多少人关注这个课题。像我以前也只是在家里和公司同步一些文件而已，没有实时更新的必要。有强烈需求的人，就设置让客户端全程走代理，可以解决上述问题，缺点是文件的更新速度受代理服务器速度的影响，大多数情况下没有直接连接的速度快。还有一部分人当需要更新时，直接重启客户端（甚至为此写了个脚本），因为客户端只在启动时才使用https连接检查更新，这样做的缺点显而易见。</p>\n<p><img alt=\"解决Dropbox无法实时更新的问题\" src=\"http://download.williamlong.info/upload/2585_1.jpg\" /></p>\n<p>　　解决方法：最近用privoxy，发现它可以做到分流http和https，于是试验了一下，果然可以分流dropbox的客户端请求了。就是前面说的，让http 请求走代理，而https请求不走。这样即满足了实时更新的需求，又兼顾了更新速度，可谓智能代理了。privoxy还有不少替代方案笔者没有试过的，比如polipo之类。以下是操作步骤。</p>\n<p>　　1，需要准备的东西：dropbox客户端、代理软件、privoxy。该方案应该与平台无关，但是笔者只在windows 7下试验过。</p>\n<p>　　2，打开privoxy的配置文件config.txt，在最后面添加这几行：</p>\n<p>#   for dropbox: http &#8211;> SOCKS Proxy(19841), https &#8211;> direct<br /> forward-socks5   .dropbox.com             127.0.0.1:19841 .<br /> forward          .dropbox.com:443         .</p>\n<p>　　注意将19841修改为你自己的代理软件的端口。如果你的代理软件不是socks类型的，那么就不是加上面的几行，而是加这几行：</p>\n<p>#   for dropbox: http &#8211;> HTTP Proxy(19842), https &#8211;> direct<br /> forward          .dropbox.com             127.0.0.1:19842<br /> forward          .dropbox.com:443         .</p>\n<p>　　注意好多地方有半角的.号，不要弄丢了。</p>\n<p>　　3，启动privoxy，将dropbox的代理设置为HTTP 127.0.0.1:8118，就OK了。</p>\n<p>　　如果有疑问可以留言讨论，如果有关于软件的其他用法的问题请另行google。</p>\n<p>　　来源：读者投稿，<a href=\"http://plusium.blogspot.com/2011/03/privoxydropbox.html\">原文链接</a>。</p>\n<p><a href=\"http://www.williamlong.info/archives/2585.html\">评论《解决Dropbox无法实时更新的问题》的内容&#8230;</a></p>\n<h3>相关文章:</h3>\n<ul>\n<p><a href=\"http://www.williamlong.info/archives/2564.html\">词典软件市场互联网词典成主流</a></p>\n<p><a href=\"http://www.williamlong.info/archives/2550.html\">浅谈WebOS与HP TouchPad</a></p>\n<p><a href=\"http://www.williamlong.info/archives/2522.html\">论应用程序商店：软件销售模式的变革</a></p>\n<p><a href=\"http://www.williamlong.info/archives/2452.html\">安全卫士的个性化</a></p>\n<p><a href=\"http://www.williamlong.info/archives/2415.html\">破釜沉舟之金山毒霸</a></p>\n</ul>\n<p><img alt=\"统计\" border=\"0\" src=\"http://img.tongji.linezing.com/707050/tongji.gif\" /><br />关于我们： 地址 &#8211; www.williamlong.info &#8211; <a href=\"http://www.google.com/reader/shared/williamlone\">我的Google Reader</a> &#8211; <a href=\"http://twitter.com/williamlong\">我的Twitter</a> <br />月光博客投稿信箱：williamlong.info(at)gmail.com</p>\n<p><b>要翻墙？(发邮件到Gmail):wangluoziyou2011ATgmail.com</b></p>\n","author":176,"categories":[9203],"tags":[]}