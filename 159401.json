{"id":159401,"link":"https://chinadigitaltimes.net/chinese/2011/06/如何每半个小时更新免费vpn的密码/","date":"2011-06-09T03:30:20Z","modified":"2011-06-09T03:30:20Z","title":"如何每半个小时更新免费VPN的密码?","content":"<p><p>来源：<a href=\"http://www.yishanhome.com/archives/1241\">http://www.yishanhome.com/archives/1241</a>    </p>\n<div>\n<div>\n<div>\n<div>\n<p><a href=\"http://www.yishanhome.com/wp-content/uploads/2011/04/freevpn.jpg\"><img alt=\"\" height=\"86\" src=\"http://www.yishanhome.com/wp-content/uploads/2011/04/freevpn-300x86.jpg\" title=\"freevpn\" width=\"300\" /></a>              <br />作用：自动发布一个每半个小时更新免费VPN密码。<span></span>              <br />请编辑注释的内容后再部署</p>\n<div><span><sup><a href=\"http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples\" title=\"WP-CodeBox HowTo?\"><span>?</span></a></sup></span><span><a>View Code</a> BASH</span></div>\n<div>\n<table>\n<tbody>\n<tr>\n<td>\n<pre><span>#!/bin/bash</span> <span>wwwtxt</span>=<span>/</span>home<span>/</span>html<span>/</span>freevpn.txt  <span>//</span>VPN服务器的文本存放的WWW位置 <span>vpnsh</span>=<span>/</span><span>$HOME</span><span>/</span>freevpn.sh <span>//</span>存放计划任务执行的位置 <span>wwwphp</span>=<span>/</span>home<span>/</span>html<span>/</span>freevpn.php  <span>//</span>公布密码服务器WWW文件位置 <span>DBName</span>=vnpdb    <span>//</span>管理VPN帐号的数据库名称 <span>DBPass</span>=mysqlpwd  <span>//</span>你的MYSQL密码 yum <span>-y</span> <span>install</span> expect <span>//</span>安装随机密码支持 <span>EOF</span>=EOF <span>cat</span> <span>></span> <span>$vpnsh</span> <span><<EOF pass=`mkpasswd -l 8 -d 8 -c 0 -C 0 -s 0` year=`date \"+%Y\"` month=`date \"+%m\"` day=`date \"+%d\"` hour=`date \"+%H\"` min=`date \"+%M\"` sec=`date \"+%S\"` #sed -i \"3s/.*/vpn pptpd $pass */\" /etc/ppp/chap-secrets //非mysql数据库管理PPTP密码，采用这个方式可以注释掉下面的MYSQL命令 mysql=`which mysql` statement=\"UPDATE userlist SET pwd = &#39;$pass&#39;,uptime=now() WHERE username =&#39;free&#39;\"    $mysql $DBName -u root -p$DBPass<<EOF    $statement $EOF #/etc/rc.d/init.d/pptpd restart-kill //重置PPTP连接 #service pptpd restart //重启PPTP连接，和上一条命令区别在于不会中断当前连接 cat /dev/null > $wwwtxt echo $year >> $wwwtxt echo $month >> $wwwtxt echo $day >> $wwwtxt echo $hour >> $wwwtxt echo $min >> $wwwtxt echo $sec >> $wwwtxt echo $pass >> $wwwtxt EOF</span> <span>echo</span> <span>\"*/30 * * * * root <span>$vpnsh</span>\"</span> <span>>>/</span>etc<span>/</span>crontab <span>//</span>添加每半小时更新密码到计划任务 <span>chmod</span> +x vpnsh <span>//</span>给予执行权限 service crond restart <span>cat</span> <span>></span> <span>$wwwphp</span> <span><<EOF <?php $file=\"$vpnwwwtxt\"; $filetext=file($file); $timestamp=mktime($filetext[3],$filetext[4],$filetext[5],$filetext[1],$filetext[2],$filetext[0]); $timestamp=$timestamp+1800; $year=date(\"Y\",$timestamp); $month=date(\"m\",$timestamp); $day=date(\"d\",$timestamp); $hour=date(\"H\",$timestamp); $min=date(\"i\",$timestamp); $sec=date(\"s\",$timestamp); ?> Server Address:$ServerAddress<br> Free Account:$FreeAccount<br> Random password: <?=$filetext[6]?><br> <embed src=\"<a href=\"http://www.clocklink.com/clocks/9001e-blue.swf?TimeZone=GMT-0400&#038;Target=\">http://www.clocklink.com/clocks/9001e-blue.swf?TimeZone=GMT-0400&Target=</a><?=$year?>,<?=$month?>,<?=$day?>,<?=$hour?>,<?=$min?>,<?=$sec?>&Title=%E8%B7%9D%E4%B8%8B%E4%B8%80%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%AF%86%E7%A0%81&Message=%E5%AF%86%E7%A0%81%E5%B7%B2%E6%9B%B4%E6%96%B0%EF%BC%8C%E8%AF%B7%E5%88%B7%E6%96%B0%EF%BC%81&\" width=\"320\" height=\"20\" wmode=\"transparent\" type=\"application/x-shockwave-flash\"> EOF</span></pre>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p><a href=\"http://www.yishanhome.com/wp-content/uploads/2011/04/freevpn.sh\">下载freevpn代码</a></p>\n<p>演示：<a href=\"http://www.yishanhome.com/freevpn\">http://www.yishanhome.com/freevpn</a></p>\n</p>\n</div>\n</div>\n</div>\n</div>\n<p>  <a href=\"http://feeds.wordpress.com/1.0/gocomments/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/comments/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godelicious/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/delicious/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gofacebook/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/facebook/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gotwitter/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/twitter/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/gostumble/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/stumble/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/godigg/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/digg/xijie.wordpress.com/4588/\" /></a> <a href=\"http://feeds.wordpress.com/1.0/goreddit/xijie.wordpress.com/4588/\" rel=\"nofollow\"><img alt=\"\" border=\"0\" src=\"http://feeds.wordpress.com/1.0/reddit/xijie.wordpress.com/4588/\" /></a> <img alt=\"\" border=\"0\" height=\"1\" src=\"http://stats.wordpress.com/b.gif?host=xijie.wordpress.com&#038;blog=10068099&#038;post=4588&#038;subd=xijie&#038;ref=&#038;feed=1\" width=\"1\" /></p>\n<p><img src=\"http://chinadigitaltimes.net/chinese/files/2011/06/52266567evpn-300x86.jpg-150x86.jpg\" /></p>\n<p><small>本文由自动聚合程序取自网络，内容和观点不代表数字时代立场</small></p>\n<form method=\"POST\" action=\"http://www.feedblitz.com/f/f.fbz?AddNewUserDirect\">\n定期获得翻墙信息？<a href=\"http://www.feedblitz.com/f/?Sub=750556\">请电邮订阅数字时代</a> <br /><input name=\"EMAIL\" maxlength=\"64\" type=\"text\" size=\"25\" value=\"\"><br />\n<input name=\"FEEDID\" type=\"hidden\" value=\"750556\"><br />\n<input name=\"PUBLISHER\" type=\"hidden\" value=\"7485568\"><br />\n<input type=\"submit\" value=\"订阅!\"><br />\n</form>\n","author":70,"categories":[15300],"tags":[8510,8795]}